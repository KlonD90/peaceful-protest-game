!function(e){function t(r){if(i[r])return i[r].exports;var s=i[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="dist/",t(t.s=318)}([,,,,,,,,function(e,t,i){"use strict";i.d(t,"Q",function(){return r}),i.d(t,"P",function(){return s}),i.d(t,"k",function(){return a}),i.d(t,"i",function(){return n}),i.d(t,"g",function(){return o}),i.d(t,"h",function(){return h}),i.d(t,"j",function(){return l}),i.d(t,"b",function(){return u}),i.d(t,"f",function(){return c}),i.d(t,"d",function(){return p}),i.d(t,"a",function(){return d}),i.d(t,"c",function(){return m}),i.d(t,"e",function(){return f}),i.d(t,"_1",function(){return g}),i.d(t,"_2",function(){return y}),i.d(t,"_0",function(){return v}),i.d(t,"Z",function(){return b}),i.d(t,"m",function(){return w}),i.d(t,"l",function(){return k}),i.d(t,"Y",function(){return x}),i.d(t,"U",function(){return z}),i.d(t,"W",function(){return T}),i.d(t,"V",function(){return j}),i.d(t,"X",function(){return O}),i.d(t,"O",function(){return P}),i.d(t,"N",function(){return A}),i.d(t,"M",function(){return M}),i.d(t,"u",function(){return _}),i.d(t,"z",function(){return C}),i.d(t,"C",function(){return S}),i.d(t,"D",function(){return W}),i.d(t,"B",function(){return E}),i.d(t,"A",function(){return D}),i.d(t,"n",function(){return R}),i.d(t,"p",function(){return N}),i.d(t,"o",function(){return F}),i.d(t,"y",function(){return B}),i.d(t,"w",function(){return H}),i.d(t,"v",function(){return G}),i.d(t,"x",function(){return I}),i.d(t,"L",function(){return L}),i.d(t,"J",function(){return V}),i.d(t,"K",function(){return U}),i.d(t,"t",function(){return q}),i.d(t,"q",function(){return Y}),i.d(t,"s",function(){return K}),i.d(t,"r",function(){return X}),i.d(t,"H",function(){return Q}),i.d(t,"I",function(){return J}),i.d(t,"E",function(){return Z}),i.d(t,"F",function(){return $}),i.d(t,"G",function(){return ee}),i.d(t,"R",function(){return te}),i.d(t,"S",function(){return ie}),i.d(t,"T",function(){return re});var r="ru",s="en",a={top:150,right:50,bottom:50,left:50},n="timeOut",o="playerKilled",h="protestRate",l="win",u="enter",c="wander",p="pursue",d="convoy",m="fight",f="stun",g="hide",y="hunt",v="hide",b="drive",w="normal",k="capture",x="wander",z="arrested",T="leave",j="follow",O="nod",P="wander",A="shooting",M="follow",_="gameTitle",C="menuBack",S="menuLevel1",W="menuLevel2",E="menuHowTo",D="menuControls",R="controlsMove",N="controlsRun",F="controlsPoster",B="howToScale",H="howToCheer",G="howToCall",I="howToCops",L="uiScale",V="uiLoading",U="uiPause",q="endWin",Y="endArrested",K="endTime",X="endFail",Q="statsTime",J="statsTotal",Z="statsActive",$="statsArrested",ee="statsLeft",te="fight",ie="normal",re="stun"},,,,,,function(e,t){var i={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4};e.exports=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){function i(e){for(var t=[[e.x,e.y]];e.parent;)e=e.parent,t.push([e.x,e.y]);return t.reverse()}function r(e,t){var r=i(e),s=i(t);return r.concat(s.reverse())}function s(e){var t,i,r,s,a,n=0;for(t=1;t<e.length;++t)i=e[t-1],r=e[t],s=i[0]-r[0],a=i[1]-r[1],n+=Math.sqrt(s*s+a*a);return n}function a(e,t,i,r){var s,a,n,o,h,l,u=Math.abs,c=[];for(n=u(i-e),o=u(r-t),s=e<i?1:-1,a=t<r?1:-1,h=n-o;;){if(c.push([e,t]),e===i&&t===r)break;l=2*h,l>-o&&(h-=o,e+=s),l<n&&(h+=n,t+=a)}return c}function n(e){var t,i,r,s,n,o,h=[],l=e.length;if(l<2)return h;for(n=0;n<l-1;++n)for(t=e[n],i=e[n+1],r=a(t[0],t[1],i[0],i[1]),s=r.length,o=0;o<s-1;++o)h.push(r[o]);return h.push(e[l-1]),h}function o(e,t){var i,r,s,n,o,h,l,u,c,p,d,m=t.length,f=t[0][0],g=t[0][1],y=t[m-1][0],v=t[m-1][1];for(i=f,r=g,o=[[i,r]],h=2;h<m;++h){for(u=t[h],s=u[0],n=u[1],c=a(i,r,s,n),d=!1,l=1;l<c.length;++l)if(p=c[l],!e.isWalkableAt(p[0],p[1])){d=!0;break}d&&(lastValidCoord=t[h-1],o.push(lastValidCoord),i=lastValidCoord[0],r=lastValidCoord[1])}return o.push([y,v]),o}function h(e){if(e.length<3)return e;var t,i,r,s,a,n,o=[],h=e[0][0],l=e[0][1],u=e[1][0],c=e[1][1],p=u-h,d=c-l;for(a=Math.sqrt(p*p+d*d),p/=a,d/=a,o.push([h,l]),n=2;n<e.length;n++)t=u,i=c,r=p,s=d,u=e[n][0],c=e[n][1],p=u-t,d=c-i,a=Math.sqrt(p*p+d*d),p/=a,d/=a,p===r&&d===s||o.push([t,i]);return o.push([u,c]),o}t.backtrace=i,t.biBacktrace=r,t.pathLength=s,t.interpolate=a,t.expandPath=n,t.smoothenPath=o,t.compressPath=h},,,,,,,,,function(e,t){e.exports={manhattan:function(e,t){return e+t},euclidean:function(e,t){return Math.sqrt(e*e+t*t)},octile:function(e,t){var i=Math.SQRT2-1;return e<t?i*e+t:i*t+e},chebyshev:function(e,t){return Math.max(e,t)}}},,,,,,,,,,,function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(){function e(t){var i=t.game,s=t.x,n=t.y,o=t.speed,h=t.spriteKey,l=t.spriteName,u=t.props,c=t.GameObject,p=t.moveTo;r(this,e),this.props=u,this.game=i,this.GameObject=c,this.speed=a({current:o.value},o),this.viewSprite=this.game.add.sprite(s,n,h,0),this.sprite=this.game.add.sprite(s,n),this.sprite.mz=this,this.viewSprite.mz=this,this.sprite.name=l,this.sprite.anchor.set(.5),this.sprite.addChild(this.viewSprite),this.game.physics.arcade.enable(this.sprite),this.game.physics.arcade.enable(this.viewSprite),this.sprite.body.reset(this.sprite.x,this.sprite.y),this.viewSprite.anchor.set(.5),this.viewSprite.reset(0,0),console.log(this.viewSprite),this.stayingTimer=this.game.time.create(!1),this.mode=null,this.moveTo=p}return n(e,[{key:"update",value:function(){}},{key:"setMode",value:function(e){this.mode=e}},{key:"setSpeed",value:function(e){this.speed.current!==e&&(this.speed.current=e)}},{key:"setVelocity",value:function(e){var t=this.game.math.angleBetweenPoints(this.sprite.body.center,e);this.game.physics.arcade.velocityFromRotation(t,this.speed.current,this.sprite.body.velocity),this.viewSprite.rotation=t-Math.PI/2}},{key:"getNextCoords",value:function(e){var t=[];e||(e={top:this.sprite.y-this.sprite.top+s.k.top,right:this.game.world.width-(this.sprite.right-this.sprite.x),bottom:this.game.world.height-(this.sprite.bottom-this.sprite.y),left:this.sprite.x-this.sprite.left}),this.sprite.x>e.left&&t.push("left"),this.sprite.x<e.right&&t.push("right"),this.sprite.y>e.top&&t.push("top"),this.sprite.y<e.bottom&&t.push("bottom");var i=this.game.rnd.between(0,t.length-1),r=this.sprite.x,a=this.sprite.y;switch(t[i]){case"left":r=this.game.rnd.between(e.left,this.sprite.x-1);break;case"right":r=this.game.rnd.between(this.sprite.x+1,e.right);break;case"top":a=this.game.rnd.between(e.top,this.sprite.y-1);break;case"bottom":a=this.game.rnd.between(this.sprite.y+1,e.bottom)}return{x:Math.round(r),y:Math.round(a)}}},{key:"updateProgressBar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:65280;this.progressBar.clear(),0!==(e=this.game.math.clamp(e,0,1))&&(this.progressBar.lineStyle(1,t,1),this.progressBar.drawRect(-12.5,-32.5,25,5),this.progressBar.lineStyle(5,t,1),this.progressBar.moveTo(-12.5,-30),this.progressBar.lineTo(Math.round(25*(-.5+e)),-30))}},{key:"stop",value:function(){this.sprite.body.stop()}},{key:"stopWandering",value:function(){this.moveTo(null),this.stayingTimer.stop(!0)}},{key:"revive",value:function(){this.sprite.body.enable=!0,this.sprite.revive(1)}},{key:"kill",value:function(){this.mode=null,this.moveTo(null),this.sprite.kill()}}]),e}();t.a=o},function(e,t,i){e.exports=i(404)},function(e,t,i){function r(e){e=e||{},this.heuristic=e.heuristic||n.manhattan,this.trackJumpRecursion=e.trackJumpRecursion||!1}var s=i(63),a=i(42),n=i(51);i(14);r.prototype.findPath=function(e,t,i,r,n){var o,h=this.openList=new s(function(e,t){return e.f-t.f}),l=this.startNode=n.getNodeAt(e,t),u=this.endNode=n.getNodeAt(i,r);for(this.grid=n,l.g=0,l.f=0,h.push(l),l.opened=!0;!h.empty();){if(o=h.pop(),o.closed=!0,o===u)return a.expandPath(a.backtrace(u));this._identifySuccessors(o)}return[]},r.prototype._identifySuccessors=function(e){var t,i,r,s,a,o,h,l,u,c,p=this.grid,d=this.heuristic,m=this.openList,f=this.endNode.x,g=this.endNode.y,y=e.x,v=e.y,b=Math.abs;Math.max;for(t=this._findNeighbors(e),s=0,a=t.length;s<a;++s)if(i=t[s],r=this._jump(i[0],i[1],y,v)){if(o=r[0],h=r[1],c=p.getNodeAt(o,h),c.closed)continue;l=n.octile(b(o-y),b(h-v)),u=e.g+l,(!c.opened||u<c.g)&&(c.g=u,c.h=c.h||d(b(o-f),b(h-g)),c.f=c.g+c.h,c.parent=e,c.opened?m.updateItem(c):(m.push(c),c.opened=!0))}},e.exports=r},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";function r(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=i(62),h=i(8),l=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),u=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},c=function(e){function t(e){var i=e.onDropPoster,n=r(e,["onDropPoster"]);s(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return o.injurySprite=o.viewSprite.addChild(o.game.make.sprite(-15,-o.sprite.height/2-2,"injury")),o.injurySprite.bringToTop(),o.injurySprite.visible=!1,o.posterSprite=o.viewSprite.addChild(o.game.make.sprite(-10,11,"poster",0)),o.posterSprite.bringToTop(),o.posterSprite.anchor.set(.5,1),o.posterSprite.visible=!1,o.showPoster=!1,o.dropPoster=1,o.onDropPoster=i,o}return n(t,e),l(t,[{key:"update",value:function(){this.injurySprite.visible=1!==this.sprite.health,this.posterSprite.visible=this.posterSprite.alive&&this.showPoster}},{key:"setMode",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case h.U:this.dropPosterRnd(),this.moveTo(null);var r=i.x,s=i.y,a=i.by;this.sprite.x=r,this.sprite.y=s,a&&a.onArrest&&a.onArrest(this)}u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e,i)}},{key:"dropPosterRnd",value:function(){this.game.rnd.frac()<this.dropPoster&&(this.posterSprite.kill(),this.onDropPoster&&this.onDropPoster({x:this.sprite.x,y:this.sprite.y}))}}]),t}(o.a);t.a=c},function(e,t){function i(e,t,i){this.x=e,this.y=t,this.walkable=void 0===i||i}e.exports=i},function(e,t,i){function r(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.heuristic=e.heuristic||n.manhattan,this.weight=e.weight||1,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never),this.diagonalMovement===o.Never?this.heuristic=e.heuristic||n.manhattan:this.heuristic=e.heuristic||n.octile}var s=i(63),a=i(42),n=i(51),o=i(14);r.prototype.findPath=function(e,t,i,r,n){var o,h,l,u,c,p,d,m,f=new s(function(e,t){return e.f-t.f}),g=n.getNodeAt(e,t),y=n.getNodeAt(i,r),v=this.heuristic,b=this.diagonalMovement,w=this.weight,k=Math.abs,x=Math.SQRT2;for(g.g=0,g.f=0,f.push(g),g.opened=!0;!f.empty();){if(o=f.pop(),o.closed=!0,o===y)return a.backtrace(y);for(h=n.getNeighbors(o,b),u=0,c=h.length;u<c;++u)l=h[u],l.closed||(p=l.x,d=l.y,m=o.g+(p-o.x==0||d-o.y==0?1:x),(!l.opened||m<l.g)&&(l.g=m,l.h=l.h||w*v(k(p-i),k(d-r)),l.f=l.g+l.h,l.parent=o,l.opened?f.updateItem(l):(f.push(l),l.opened=!0)))}return[]},e.exports=r},function(e,t,i){function r(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||n.manhattan,this.weight=e.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never),this.diagonalMovement===o.Never?this.heuristic=e.heuristic||n.manhattan:this.heuristic=e.heuristic||n.octile}var s=i(63),a=i(42),n=i(51),o=i(14);r.prototype.findPath=function(e,t,i,r,n){var o,h,l,u,c,p,d,m,f=function(e,t){return e.f-t.f},g=new s(f),y=new s(f),v=n.getNodeAt(e,t),b=n.getNodeAt(i,r),w=this.heuristic,k=this.diagonalMovement,x=this.weight,z=Math.abs,T=Math.SQRT2;for(v.g=0,v.f=0,g.push(v),v.opened=1,b.g=0,b.f=0,y.push(b),b.opened=2;!g.empty()&&!y.empty();){for(o=g.pop(),o.closed=!0,h=n.getNeighbors(o,k),u=0,c=h.length;u<c;++u)if(l=h[u],!l.closed){if(2===l.opened)return a.biBacktrace(o,l);p=l.x,d=l.y,m=o.g+(p-o.x==0||d-o.y==0?1:T),(!l.opened||m<l.g)&&(l.g=m,l.h=l.h||x*w(z(p-i),z(d-r)),l.f=l.g+l.h,l.parent=o,l.opened?g.updateItem(l):(g.push(l),l.opened=1))}for(o=y.pop(),o.closed=!0,h=n.getNeighbors(o,k),u=0,c=h.length;u<c;++u)if(l=h[u],!l.closed){if(1===l.opened)return a.biBacktrace(l,o);p=l.x,d=l.y,m=o.g+(p-o.x==0||d-o.y==0?1:T),(!l.opened||m<l.g)&&(l.g=m,l.h=l.h||x*w(z(p-e),z(d-t)),l.f=l.g+l.h,l.parent=o,l.opened?y.updateItem(l):(y.push(l),l.opened=2))}}return[]},e.exports=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var r={initial:[{type:"spritesheet",key:"langButtons",url:i(320),frameWidth:50,frameHeight:50}],helpTouch:[{type:"spritesheet",key:"helpMove",url:i(321),frameWidth:100,frameHeight:100},{type:"spritesheet",key:"helpRun",url:i(322),frameWidth:100,frameHeight:100},{type:"spritesheet",key:"helpPoster",url:i(323),frameWidth:70,frameHeight:70}],helpDesktop:[{type:"spritesheet",key:"helpMove",url:i(324),frameWidth:150,frameHeight:50},{type:"spritesheet",key:"helpRun",url:i(325),frameWidth:150,frameHeight:50},{type:"spritesheet",key:"helpPoster",url:i(326),frameWidth:250,frameHeight:50}],helpTips:[{type:"image",key:"space_pozor",url:i(327),frameWidth:338,frameHeight:74},{type:"image",key:"space_fight",url:i(328),frameWidth:338,frameHeight:74},{type:"image",key:"shift_run",url:i(329),frameWidth:338,frameHeight:74},{type:"image",key:"journalists",url:i(330),frameWidth:338,frameHeight:74}],tweets:[{type:"image",key:"tw_styazshkin",url:i(331),frameWidth:400,frameHeight:400},{type:"image",key:"tw_granitweet",url:i(332),frameWidth:400,frameHeight:400},{type:"image",key:"tw_vigimadi",url:i(333),frameWidth:400,frameHeight:400},{type:"image",key:"tw_ovdinfo",url:i(334),frameWidth:400,frameHeight:400},{type:"image",key:"tw_koshelyaeva",url:i(335),frameWidth:400,frameHeight:400},{type:"image",key:"tw_brewerov",url:i(336),frameWidth:400,frameHeight:400},{type:"image",key:"tw_asilikedem",url:i(337),frameWidth:400,frameHeight:400},{type:"image",key:"tw_fb_pal",url:i(338),frameWidth:400,frameHeight:400},{type:"image",key:"tw_ya_yanson",url:i(339),frameWidth:400,frameHeight:400},{type:"image",key:"tw_galiamina",url:i(340),frameWidth:400,frameHeight:400},{type:"image",key:"tw_ogonwatch",url:i(341),frameWidth:400,frameHeight:400},{type:"image",key:"tw_the_ins_ru",url:i(342),frameWidth:400,frameHeight:400},{type:"image",key:"tw_kirilenko_a",url:i(343),frameWidth:400,frameHeight:400},{type:"image",key:"tw_tvrain",url:i(344),frameWidth:400,frameHeight:400},{type:"image",key:"tw_gruppa_voina",url:i(345),frameWidth:400,frameHeight:400},{type:"image",key:"tw_kszhivago",url:i(346),frameWidth:400,frameHeight:400},{type:"image",key:"tw_plushev",url:i(347),frameWidth:400,frameHeight:400},{type:"image",key:"tw_aban_in",url:i(348),frameWidth:400,frameHeight:400},{type:"image",key:"tw_rrubanov",url:i(349),frameWidth:400,frameHeight:400},{type:"image",key:"tw_navalny",url:i(350),frameWidth:400,frameHeight:400},{type:"image",key:"tw_noliquid",url:i(351),frameWidth:400,frameHeight:400},{type:"image",key:"tw_varlamov",url:i(352),frameWidth:400,frameHeight:400},{type:"image",key:"tw_mediazzzona",url:i(353),frameWidth:400,frameHeight:400},{type:"image",key:"tw_zhuravleva",url:i(354),frameWidth:400,frameHeight:400},{type:"image",key:"tw_asluhn",url:i(355),frameWidth:400,frameHeight:400},{type:"image",key:"tw_evgenyfeldman",url:i(356),frameWidth:400,frameHeight:400}],levelCommon:[{type:"spritesheet",key:"playButton",url:i(357),frameWidth:100,frameHeight:100},{type:"spritesheet",key:"paddy_wagon",url:i(358),frameWidth:120,frameHeight:300},{type:"spritesheet",key:"klyaksa",url:i(359),frameWidth:1035,frameHeight:1035},function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}({type:"spritesheet",key:"star",url:i(360),frameHeight:30},"frameHeight",30),{type:"spritesheet",key:"repeatButton",url:i(361),frameWidth:100,frameHeight:100},{type:"spritesheet",key:"soundButtons",url:i(125),frameWidth:50,frameHeight:50},{type:"spritesheet",key:"podskazka_plakat",url:i(125),frameWidth:50,frameHeight:50},{type:"audio",key:"theme",urls:i(362)},{type:"audio",key:"punch01",urls:i(363)},{type:"audio",key:"punch02",urls:i(364)},{type:"audio",key:"applause",urls:i(365)},{type:"audio",key:"boo",urls:i(366)},{type:"audio",key:"croud",urls:i(367)},{type:"audio",key:"scream03",urls:i(368)},{type:"audio",key:"truck",urls:i(369)},{type:"audio",key:"pick",urls:i(370)}],level1:[{type:"spritesheet",key:"border",url:i(126),frameWidth:100,frameHeight:50},{type:"spritesheet",key:"auto",url:i(127),frameWidth:290,frameHeight:135},{type:"spritesheet",key:"cop",url:i(371),frameWidth:44,frameHeight:49},{type:"spritesheet",key:"shield",url:i(128),frameWidth:316,frameHeight:140},{type:"spritesheet",key:"journalist",url:i(129),frameWidth:32,frameHeight:49},{type:"spritesheet",key:"player",url:i(130),frameWidth:30,frameHeight:46},{type:"spritesheet",key:"player_sprite",url:i(372),frameWidth:31,frameHeight:37,frameMax:3,margin:0,spacing:0},{type:"spritesheet",key:"protester_sprite",url:i(373),frameWidth:31,frameHeight:37,frameMax:3,margin:0,spacing:0},{type:"spritesheet",key:"cop_sprite",url:i(374),frameWidth:31,frameHeight:37,frameMax:3,margin:0,spacing:0},{type:"spritesheet",key:"press_sprite",url:i(375),frameWidth:31,frameHeight:37,frameMax:3,margin:0,spacing:0},{type:"spritesheet",key:"protester1",url:i(131),frameWidth:32,frameHeight:48},{type:"spritesheet",key:"protester2",url:i(132),frameWidth:30,frameHeight:46},{type:"spritesheet",key:"protester3",url:i(133),frameWidth:30,frameHeight:47},{type:"spritesheet",key:"injury",url:i(134),frameWidth:30,frameHeight:31},{type:"spritesheet",key:"poster",url:i(135),frameWidth:60,frameHeight:71},{type:"image",key:"ground",url:i(376),overwrite:!1},{type:"image",key:"meeting_map",url:i(377),overwrite:!1}],level2:[{type:"spritesheet",key:"border",url:i(126),frameWidth:100,frameHeight:50},{type:"spritesheet",key:"auto",url:i(127),frameWidth:290,frameHeight:135},{type:"spritesheet",key:"cop",url:i(378),frameWidth:46,frameHeight:54},{type:"spritesheet",key:"swat",url:i(379),frameWidth:30,frameHeight:46},{type:"spritesheet",key:"shield",url:i(128),frameWidth:316,frameHeight:140},{type:"spritesheet",key:"journalist",url:i(129),frameWidth:32,frameHeight:49},{type:"spritesheet",key:"player",url:i(130),frameWidth:30,frameHeight:46},{type:"spritesheet",key:"protester1",url:i(131),frameWidth:32,frameHeight:48},{type:"spritesheet",key:"protester2",url:i(132),frameWidth:30,frameHeight:46},{type:"spritesheet",key:"protester3",url:i(133),frameWidth:30,frameHeight:47},{type:"spritesheet",key:"injury",url:i(134),frameWidth:30,frameHeight:31},{type:"spritesheet",key:"poster",url:i(135),frameWidth:60,frameHeight:71},{type:"image",key:"ground",url:i(380),overwrite:!1}]};t.a=JSON.stringify(r)},function(e,t,i){e.exports=i.p+"assets/e2ca73497a9d43a9891bdd004f7842b5.png"},function(e,t,i){e.exports=i.p+"assets/6de19dd8a50184e808601049e3864f02.png"},function(e,t,i){e.exports=i.p+"assets/570cb45ba3589144f3858f3d0385a88d.png"},function(e,t,i){e.exports=i.p+"assets/75acaf7dc3fb09428e30d09953735c10.png"},function(e,t,i){e.exports=i.p+"assets/0db8c7aedd9b6876feb9ee4371b27d14.png"},function(e,t,i){e.exports=i.p+"assets/c73e25fb0b044d025cd031db52c0704b.png"},function(e,t,i){e.exports=i.p+"assets/c319d1c800f4e0f8c49b21f55ef1ee16.png"},function(e,t,i){e.exports=i.p+"assets/51eaa920cd842f906dbb0ab9dafb2046.png"},function(e,t,i){e.exports=i.p+"assets/373325f07721a6c1f012d59948a7b889.png"},function(e,t,i){e.exports=i.p+"assets/d4bedbdde1c2adef9d869553fe67a350.png"},function(e,t,i){e.exports=i.p+"assets/28dbeb6c57f67cd17abbd912371bac9c.png"},function(e,t,i){"use strict";function r(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=i(89),h=i(137),l=i(8),u=i(138),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},p=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),d=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},m=function(e){function t(e){var i=e.fovGroup,n=e.radius,o=e.cheering,l=e.stamina,u=e.staminaCooldown,p=e.powerUp,d=e.powerDown,m=e.slots,f=r(e,["fovGroup","radius","cheering","stamina","staminaCooldown","powerUp","powerDown","slots"]);s(this,t);var g=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c({spriteKey:"player_sprite",spriteName:"player"},f)));g.sprite.inputEnabled=!0,g.sprite.input.priorityID=1,g.sprite.body.collideWorldBounds=!0,g.sprite.body.mass=7,g.sprite.body.setSize(37,37),g.direction=0,g.power=1,g.powerUpValue=p,g.powerDownValue=d,g.powerTimer=g.game.time.create(!1),g.powerTimer.loop(2e3,g.powerDown,g),g.powerTimer.start(),g.cheering=o,g.stamina=l,g.maxStamina=l,g.cooldownTimer=g.game.time.create(!1),g.staminaCooldown=1e3*u,g.tapStartTimestamp=Date.now(),g.tapDelta=1/0,g.progressBar=g.game.add.graphics(),g.sprite.addChild(g.progressBar),g.audioScream=g.game.add.audio("scream03"),g.showPoster=!1,g.isFrozen=!1,g.isGoing=!1,g.stunTimer=g.game.time.create(!1),g.slots=new h.a(g.sprite,g,m||[{x:-30,y:0},{x:-30,y:30},{x:-30,y:-30},{x:-30,y:-60}]),g.radius={initial:n,graphic:0,actual:0,actualSq:0,tween:{}},g.resetRadius(),g.circleGraphics=g.game.add.graphics(0,0),i.add(g.circleGraphics),g.game.onResume.add(g.handleGameResume,g),g.keys={up:g.game.input.keyboard.addKey(Phaser.Keyboard.UP),down:g.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),left:g.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),right:g.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),space:g.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),shift:g.game.input.keyboard.addKey(Phaser.Keyboard.SHIFT)},g.sprite.smoothed=!0;return g.viewSprite.animations.add("walk",[1,2],3,!0),g.viewSprite.animations.add("run",[1,2],3*g.speed.running,!0),g.fightBar=0,t.instance=g,g}return n(t,e),p(t,[{key:"update",value:function(){var e=this;if(this.resetRadius(),this.slots.update(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),this.circleGraphics.clear(),this.mode===l.U||this.isFrozen||this.mode===l.T)return void this.updateProgressBar(0);if(this.mode===l.R)return this.keys.space.justDown&&(this.fightBar+=1),void this.updateFightBar();this.circleGraphics.lineStyle(1,3407667,1),this.circleGraphics.drawCircle(this.sprite.x,this.sprite.y,2*this.radius.graphic);var i=this.speed.value,r=this.keys.up.isDown||this.keys.down.isDown||this.keys.left.isDown||this.keys.right.isDown;if(this.cooldownTimer.running?(this.stamina=this.maxStamina*this.cooldownTimer.ms/this.staminaCooldown,this.isRunning&&(this.isRunning=!1,this.viewSprite.animations.play("walk"))):r&&this.keys.shift.isDown||this.tapDelta<200?(this.GameObject.mz.advices.space_pozor&&!1===this.GameObject.mz.advices.shift_run&&(u.a.hide("shift_run"),this.GameObject.mz.advices.shift_run=!0),this.stamina>0?(this.stamina-=1,i*=this.speed.running,this.isRunning||(this.isRunning=!0,this.viewSprite.animations.play("run"))):(this.cooldownTimer.add(this.staminaCooldown,function(){e.cooldownTimer.stop(!0)}),this.cooldownTimer.start(),this.isRunning&&(this.isRunning=!1,this.viewSprite.animations.play("walk")))):this.stamina<this.maxStamina&&(this.stamina+=1,this.isRunning&&(this.isRunning=!1,this.viewSprite.animations.play("walk"))),this.stamina<this.maxStamina?this.updateProgressBar(this.stamina/this.maxStamina,this.cooldownTimer.running?16711680:65280):this.updateProgressBar(0),this.showPoster&&(i*=this.speed.withPoster),this.setSpeed(i),this.viewSprite.angle=this.direction-90,r){this.moveTo(null);var s=[];this.keys.up.isDown&&s.push(-90),this.keys.down.isDown&&s.push(90),this.keys.left.isDown&&(this.keys.up.isDown?s.push(-180):s.push(180)),this.keys.right.isDown&&s.push(0);var a=s.reduce(function(e,t){return t+e},0)/s.length;this.direction=a,this.game.physics.arcade.velocityFromAngle(a,this.speed.current,this.sprite.body.velocity),console.log("direction",this.direction),this.resetClickSpeed(!0),this.isGoing||(this.isGoing=!0,this.viewSprite.animations.play("walk"))}else(this.keys.up.justUp||this.keys.down.justUp||this.keys.left.justUp||this.keys.right.justUp)&&(this.isGoing=!1,this.stop());this.keys.space.justDown&&this.mode!==l.R&&(this.togglePoster(),!1===this.GameObject.mz.advices.space_pozor&&(u.a.hide("space_pozor"),this.GameObject.mz.advices.space_pozor=!0,u.a.show("shift_run")))}},{key:"handleGameResume",value:function(){this.moveTo(null)}},{key:"setMode",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(console.log("player mode",e),e){case l.U:this.sprite.body.immovable=!0,this.togglePoster(!1),this.sprite.body.collideWorldBounds=!1,this.cooldownTimer.stop(!0);break;case l.R:this.showPoster=!1,this.fightBar=10,this.GameObject.mz.timers.fight.stop(),this.GameObject.mz.timers.fight.removeAll(),this.GameObject.mz.timers.fight.loop(300,this.handleTickFight,this),this.GameObject.mz.timers.fight.add(5e3,this.handleFightLose,this),this.GameObject.mz.timers.fight.start(),this.sprite.body.immovable=!0,u.a.show("space_fight"),console.log(this.GameObject.mz.timers.fight);break;case l.T:u.a.hide("space_fight"),this.showPoster=!1,this.GameObject.mz.timers.fight.stop(),this.GameObject.mz.timers.fight.removeAll(),this.sprite.body.immovable=!0,this.stunTimer.stop(),this.stunTimer.removeAll(),this.stunTimer.add(5e3,this.handleRecoverStun,this),this.stunTween&&this.stunTween.stop(),this.stunTween=this.game.add.tween(this.viewSprite),this.stunTween.to({alpha:0},500,Phaser.Easing.Linear.None,!0,0,500,!0),this.stunTween.start(),this.stunTimer.start();break;case l.S:u.a.hide("space_fight"),this.showPoster=!1,this.stunTimer.removeAll(),this.stunTimer.stop(),this.stunTween&&this.stunTween.stop(),this.viewSprite.alpha=1,this.sprite.body.immovable=!1,this.sprite.body.enable=!0;break;default:this.sprite.body.immovable=!1}d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e,i)}},{key:"handleAlphaTick",value:function(){}},{key:"handleRecoverStun",value:function(){this.setMode(l.S)}},{key:"togglePoster",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.showPoster;e!==this.showPoster&&(e&&this.audioScream.play("",0,.1),this.showPoster=e)}},{key:"powerUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.powerUpValue;0!==e&&this.powerChange(e)}},{key:"powerDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.powerDownValue;Math.max(1,this.power-e)!==this.power&&this.powerChange(-e)}},{key:"powerChange",value:function(e){this.power+=e,this.posterSprite.scale.set(this.power)}},{key:"resetClickSpeed",value:function(e){if(e)this.tapDelta=1/0;else{var t=Date.now();this.tapDelta=t-this.tapStartTimestamp,this.tapStartTimestamp=t}}},{key:"resetRadius",value:function(){var e=this.showPoster?this.radius.initial:0;(e*=this.power)!==this.radius.actual&&(this.radius.tween.isRunning&&this.radius.tween.stop(),this.game.math.fuzzyEqual(e,this.radius.graphic,1)?this.radius.graphic=e:(this.radius.tween=this.game.add.tween(this.radius),this.radius.tween.to({graphic:e},500,Phaser.Easing.Exponential.Out),this.radius.tween.start()),this.radius.actual=e,this.radius.actualSq=Math.pow(this.radius.actual,2))}},{key:"freeze",value:function(){this.sprite.alive&&this.moveTo(null),this.isFrozen=!0}},{key:"kill",value:function(){this.game.onResume.removeAll(),this.powerTimer.stop(!0),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"kill",this).call(this)}},{key:"screenAttack",value:function(){}},{key:"updateFightBar",value:function(){this.progressBar.clear();var e=this.fightBar/20;0!==e&&(this.progressBar.lineStyle(1,268431360,1),this.progressBar.drawRect(-12.5,-32.5,25,5),this.progressBar.lineStyle(5,16711680,1),this.progressBar.moveTo(-12.5,-30),this.progressBar.lineTo(Math.round(25*(-.5+e)),-30)),e>=1&&this.handleFightWin()}},{key:"handleTickFight",value:function(){--this.fightBar<0&&(this.fightBar=0)}},{key:"handleFightWin",value:function(){this.clearTimers(),this.progressBar.clear(),this.setMode(l.S),this.GameObject.fightWin()}},{key:"handleFightLose",value:function(){this.clearTimers(),this.progressBar.clear(),this.setMode(l.T),this.GameObject.fightLose()}},{key:"clearTimers",value:function(){this.GameObject.mz.timers.fight.removeAll(),this.GameObject.mz.timers.fight.stop()}}]),t}(o.a);t.a=m},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(389),a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(t,i,a){r(this,e),this.slots=a.map(function(e){return new s.a(t,i,e)})}return a(e,[{key:"update",value:function(){this.slots.filter(function(e){return e.taken}).forEach(function(e){return e.update()})}},{key:"take",value:function(e){var t=this.slots.find(function(e){return!e.taken});return t?(t.take(e),t):null}},{key:"hasEmptySlots",value:function(){return!!this.slots.find(function(e){return!e.taken})}},{key:"dismissAll",value:function(){this.slots.forEach(function(e){e.taken&&e.taken.onSlotDismissing&&e.taken.onSlotDismissing(),e.dismiss()})}}]),e}();t.a=n},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this.sprites={}}return s(e,[{key:"setGame",value:function(e){this.game=e}},{key:"addSprite",value:function(e){var t=game.game,i=t.width,r=t.height,s=i/2-169,a=this.sprites[e]=this.game.add.sprite(s,r-130,e);return a.fixedToCamera=!0,a}},{key:"fadeIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return this.game.add.tween(e).to({alpha:1},t,Phaser.Easing.Linear.None,!0)}},{key:"fadeOut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=this.game.add.tween(e).to({alpha:1},t,Phaser.Easing.Linear.None);return i.add.onComplete(function(){e.kill()},this.game),i}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===this.game)throw new Error("HelpInfo don't have game instance");var i=this.addSprite(e);t&&(i.alpha=0,this.fadeIn(i,t))}},{key:"hide",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e)return void Object.keys(this.sprites).forEach(function(e){return t.sprites[e]&&t.sprites[e].kill()});var r=this.sprites[e];i?this.fadeOut(r,i):r.kill()}}]),e}();t.a=new a},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,n=i(8),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),h=(a={},s(a,n.m,3816022),s(a,n.l,5651002),a),l=function(){function e(t){var i=t.game,s=t.radius,a=t.angle,n=t.colors,o=void 0===n?h:n;r(this,e),this.game=i,this.radius=s,this.radiusSq=Math.pow(this.radius,2),this.halfViewAngle=this.game.math.degToRad(a/2),this.colors=o,this.graphics=this.game.add.graphics(0,0),this.center=null,this.isActive=!0}return o(e,[{key:"update",value:function(e){var t,i=e.x,r=e.y,s=e.angle,a=e.mode;if(this.center={x:i,y:r},this.angle=s,this.graphics.clear(),this.isActive){var o=this.angle-this.halfViewAngle,h=this.angle+this.halfViewAngle,l=[i+Math.cos(o)*this.radius,r+Math.sin(o)*this.radius];this.graphics.beginFill(this.colors[a||n.m],.4),this.graphics.moveTo(i,r),(t=this.graphics).lineTo.apply(t,l),this.graphics.arc(i,r,this.radius,o,h,!1,10),this.graphics.lineTo(i,r),this.graphics.endFill()}}},{key:"containsPoint",value:function(e){var t=e.x,i=e.y;if(!this.center)return!1;if(this.game.math.distanceSq(this.center.x,this.center.y,t,i)>this.radiusSq)return!1;var r=this.game.math.angleBetweenPoints(this.center,{x:t,y:i}),s=this.angle-this.halfViewAngle,a=this.angle+this.halfViewAngle;return s<=r&&r<=a||(r-=2*Math.PI*Math.sign(r),s<=r&&r<=a)}},{key:"destroy",value:function(){this.graphics.destroy(),this.isActive=!1}},{key:"kill",value:function(){this.graphics.kill(),this.isActive=!1}},{key:"revive",value:function(){this.graphics.revive(),this.isActive=!0}}]),e}();t.a=l},function(e,t,i){"use strict";function r(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t,i,r,s,a){var n=Math.PI/2*3,o=t,h=i,l=Math.PI/r;e.moveTo(t,i-s);for(var u=0;u<r;u++)o=t+Math.cos(n)*s,h=i+Math.sin(n)*s,e.lineTo(o,h),n+=l,o=t+Math.cos(n)*a,h=i+Math.sin(n)*a,e.lineTo(o,h),n+=l;e.lineTo(t,i-s)}var h=i(89),l=i(137),u=i(8),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},p=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),d=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},m=function(e,t,i,r,s){for(var a=Math.PI/2*3,n=e,o=t,h=Math.PI/i,l=[],u=0;u<i;u++)n=e+Math.cos(a)*r,o=t+Math.sin(a)*r,l.push({x:n,y:o}),a+=h,n=e+Math.cos(a)*s,o=t+Math.sin(a)*s,l.push({x:n,y:o}),a+=h;return l.push({x:e,y:t-r}),l}(0,0,3,70,50),f={interval:1,agitation:{duration:10,direction:0,slots:m},speed:100},g=function(e){function t(e){var i=e.config,n=e.GameObject,o=r(e,["config","GameObject"]);s(this,t),console.log(c({config:i,GameObject:n},o));var h=c({},f,i);console.log(o);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c({},n.getRandomCoordinates(),{spriteKey:"protester1",spriteName:"star",speed:{value:h.speed}},o,{GameObject:n})));return l.starGraphic=l.game.add.graphics(),l.sprite.addChild(l.starGraphic),l.config=h,l.restTimer=l.game.time.create(!1),l.kill(),l}return n(t,e),p(t,[{key:"setState",value:function(e){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case t.STATE.REST:this.state={type:t.STATE.REST},this.restTimer.add(1e3*this.config.interval,function(){return i.setState(t.STATE.MOVE_IN)},this),this.restTimer.start();break;case t.STATE.MOVE_IN:this.restTimer.stop(),this.revive();var s=this.GameObject.getRandomCoordinates();console.log("star coords",s),this.moveTo(s,{callback:function(){return i.setState(t.STATE.AGITATE)},phasing:!0}),this.state={type:t.STATE.MOVE_IN};break;case t.STATE.AGITATE:var a=this.config.agitation,n=a.slots,o=(a.duration,a.direction);this.direction=o,this.moveTo();var h=new l.a(this.sprite,this,n);this.state={type:t.STATE.AGITATE,slots:h};break;case t.STATE.ARRESTED:var u=this.config.agitation;u.slots,u.duration,u.direction;this.moveTo(),this.state={type:t.STATE.ARRESTED};var c=r.x,p=r.y;this.sprite.x=c,this.sprite.y=p}}},{key:"update",value:function(){switch(this.state.type){case t.STATE.AGITATE:for(var e=this.GameObject.mz.arrays.protesters.filter(function(e){return e.alive}).map(function(e){return e.mz}).filter(function(e){return e.mode===u.Y});this.state.slots.hasEmptySlots()&&e.length>0;){var i=e.shift(),r=this.state.slots.take(i);i.setMode(u.V,{slot:r})}}this.updateStarGraphic(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}},{key:"updateStarGraphic",value:function(){this.starGraphic.clear(),this.starGraphic.lineStyle(3,16776960,1),o(this.starGraphic,0,0,5,30,15)}},{key:"revive",value:function(){var e=this.GameObject.randomOffscreenCoords(),t=e.x,i=e.y;this.sprite.revive(1),this.sprite.x=t,this.sprite.y=i,this.sprite.body.reset(t,i)}},{key:"kill",value:function(){this.setState(t.STATE.REST),this.moveTo(null),this.sprite.kill()}}]),t}(h.a);g.STATE={REST:"rest",MOVE_IN:"moveIn",AGITATE:"agitate",ARRESTED:u.U},t.a=g},function(e,t,i){"use strict";function r(e){return String(Math.floor(e/60)).padStart(2,"0")+":"+String(e%60).padStart(2,"0")}t.a=r},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,i){var r=e;return r<0?r=0:r>i&&(r=i),Math.floor(r/t)+1}function a(e,t){return(e-.5)*t}var n=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),h=function(){function e(t){r(this,e),this.collider=t;var i=this.rCoordsToMCoords({x:1/0,y:1/0}),s=n(i,2),a=s[0],o=s[1];Object.assign(this,{maxX:a,maxY:o})}return o(e,[{key:"rCoordsToMCoords",value:function(e){var t=e.x,i=e.y,r=this.collider,a=r.game,n=r.scale;return[s(t,n,a.world.width),s(i,n,a.world.height)]}},{key:"mCoordsToRCoords",value:function(e){var t=n(e,2),i=t[0],r=t[1],s=this.collider.scale;return{x:a(i,s),y:a(r,s)}}}]),e}();t.a=h},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(319),s=i(383),a=i(384),n=i(386),o=i(387),h=i(388);setTimeout(function(){var e=window.innerHeight;document.body.clientHeight>e&&(document.body.style.height=e+"px",document.documentElement.style.height=e+"px");var t=document.querySelector(".js-game-container"),i=new Phaser.Game({width:t.clientWidth,height:t.clientHeight,parent:t,antialias:!0,renderer:Phaser.CANVAS});i.state.add("Boot",r.a),i.state.add("Loading",s.a),i.state.add("StartMenu",a.a),i.state.add("Help",n.a),i.state.add("Controls",o.a),i.state.add("Game",h.a),i.state.start("Boot"),window.game=i},50),document.body.style.backgroundImage="url("+i(422)+")"},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(124),a=i(381),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return n(e,[{key:"init",value:function(){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.game.mz={}}},{key:"create",value:function(){this.game.mz.i18n=new a.a({game:this.game}),this.state.onStateChange.add(this.handleStateChange,this),this.state.start("Loading",!0,!1,{assets:[["pack","initial",null,s.a],["pack","help"+(Phaser.Device.desktop?"Desktop":"Touch"),null,s.a],["pack","helpTips",null,s.a],["pack","tweets",null,s.a]],nextState:["StartMenu"]})}},{key:"handleStateChange",value:function(){this.game.mz.i18n.clear()}}]),e}();t.a=o},function(e,t,i){e.exports=i.p+"assets/66dd3dd498c059b331146e5fe01f17dd.png"},function(e,t,i){e.exports=i.p+"assets/3e736cadcb61ec5e4f210df6e7bedd19.png"},function(e,t,i){e.exports=i.p+"assets/0a98a949b4886079723975216652cf49.png"},function(e,t,i){e.exports=i.p+"assets/c96144591ab8112e33935164269d6683.png"},function(e,t,i){e.exports=i.p+"assets/4190e618de11fbf3ae3d41873529b2e0.png"},function(e,t,i){e.exports=i.p+"assets/3eb6c3176371a0f3cc4fc69f68d0daea.png"},function(e,t,i){e.exports=i.p+"assets/fde6591e1dde24e589cfc497a07e708c.png"},function(e,t,i){e.exports=i.p+"assets/7e7209b2ebbb293cced90b043b2f69c3.png"},function(e,t,i){e.exports=i.p+"assets/35dee4384b15d9d37855aabb26e87203.png"},function(e,t,i){e.exports=i.p+"assets/e0ebce32899a3e8c50f5dbf32d264911.png"},function(e,t,i){e.exports=i.p+"assets/df26508edc26ee3ebb6284d6467783fe.png"},function(e,t,i){e.exports=i.p+"assets/9fa556559461c3286dc52836c3f71295.jpg"},function(e,t,i){e.exports=i.p+"assets/6fdca65403892d28a5cb3c41916027dd.jpeg"},function(e,t,i){e.exports=i.p+"assets/73f9d1a24b95edc21231f34bd969fe60.jpg"},function(e,t,i){e.exports=i.p+"assets/ae25b01cae3eac0aae527614dea051c2.png"},function(e,t,i){e.exports=i.p+"assets/ac5e583c05f4cd726f78f03969f33638.jpg"},function(e,t,i){e.exports=i.p+"assets/7826dc2b3c0031a0b6ffdb4aaefec6b1.jpeg"},function(e,t,i){e.exports=i.p+"assets/1a3f7728b040b95b206686e4077441ee.jpg"},function(e,t,i){e.exports=i.p+"assets/36d16a2862e29abdd938c27a5781cc24.jpg"},function(e,t,i){e.exports=i.p+"assets/d57ac0086872987c1950144c4791527a.jpg"},function(e,t,i){e.exports=i.p+"assets/81739b51326452e4e37b5bbd473f9f11.jpg"},function(e,t,i){e.exports=i.p+"assets/5199bf9235868222797eba63d089fef4.jpg"},function(e,t,i){e.exports=i.p+"assets/d3291cd3470e278aac6c709a5d7e1d7a.jpeg"},function(e,t,i){e.exports=i.p+"assets/81f3d17c788178b49146a0815c54170a.jpg"},function(e,t,i){e.exports=i.p+"assets/7ca8239d678965070d563133c7ede9db.jpg"},function(e,t,i){e.exports=i.p+"assets/bc4359c1a8417a4299621e2eff961ea3.jpg"},function(e,t,i){e.exports=i.p+"assets/a038756be158829b8f3ff2f57ee34b32.jpeg"},function(e,t,i){e.exports=i.p+"assets/bab50b5ea286de92d3841a1acb66eb3f.jpeg"},function(e,t,i){e.exports=i.p+"assets/47b2bfe8b945cdf2c70cb0835d0ac419.jpeg"},function(e,t,i){e.exports=i.p+"assets/73a34c439fb4eeadcd0a201e40630ac1.png"},function(e,t,i){e.exports=i.p+"assets/213163a0d505713487737f4b815f116f.png"},function(e,t,i){e.exports=i.p+"assets/657a67d3871c7aa1d4f67961d331152e.gif"},function(e,t,i){e.exports=i.p+"assets/1a524d9f32ff68b39c508fd4686a9f74.jpg"},function(e,t,i){e.exports=i.p+"assets/98250809c2f2aa90abee630ee6b118b0.jpg"},function(e,t,i){e.exports=i.p+"assets/d26b4e184bd225dadd5dc671f2d6dcdc.jpg"},function(e,t,i){e.exports=i.p+"assets/4fd5bb2e1b096c8eea0b5d8144006856.jpg"},function(e,t,i){e.exports=i.p+"assets/5bd3b74e2a30818e8e753a03890100ca.jpg"},function(e,t,i){e.exports=i.p+"assets/784a4a24da47767dec8d65b727fc8383.png"},function(e,t,i){e.exports=i.p+"assets/6415893186a9d405eb58026c9746e687.png"},function(e,t,i){e.exports=i.p+"assets/b6f612c9937d49d43dc479b8f14b27b4.png"},function(e,t,i){e.exports=i.p+"assets/07112e036fb16b9558240ea6abdd0283.png"},function(e,t,i){e.exports=i.p+"assets/414510c3df8e81d30baba58bc049457c.png"},function(e,t,i){e.exports=i.p+"assets/31269e05cd13ab095ae3bbb217d2f567.mp3"},function(e,t,i){e.exports=i.p+"assets/0cb89b881decdf87d1ccaba4ae7aaffb.mp3"},function(e,t,i){e.exports=i.p+"assets/dca004f04dec60da50cca8fecc4161f2.mp3"},function(e,t,i){e.exports=i.p+"assets/3745bf01cd4446437f37de7991ad805b.mp3"},function(e,t,i){e.exports=i.p+"assets/52b53826ba253bf501d879893845b5f4.mp3"},function(e,t,i){e.exports=i.p+"assets/15a327358f08be2e673ef27c2e5dcaa1.mp3"},function(e,t,i){e.exports=i.p+"assets/05b4ea2cf7bcddf26622cdaafb40b881.mp3"},function(e,t,i){e.exports=i.p+"assets/b2187268a6f521f79c03adf9bedcf458.mp3"},function(e,t,i){e.exports=i.p+"assets/dd570435d42a0e42441e1fc12af0f4fa.mp3"},function(e,t,i){e.exports=i.p+"assets/d98ae72532ed2e0fe2b7596a57c1cbac.png"},function(e,t,i){e.exports=i.p+"assets/01a3edec778ecd8abce577b5c17e4840.png"},function(e,t,i){e.exports=i.p+"assets/fe70eb22139dc1362647512645898904.png"},function(e,t,i){e.exports=i.p+"assets/9932dd876dfd671a19de54942796bfcc.png"},function(e,t,i){e.exports=i.p+"assets/7cccb05e61d266b1c2fd4c80d81988d4.png"},function(e,t,i){e.exports=i.p+"assets/e8369a8e936a5b0fabd5b1b42fed03d5.png"},function(e,t,i){e.exports=i.p+"assets/fb22776fd6e175bfb11dccac3b8878af.png"},function(e,t,i){e.exports=i.p+"assets/733d7ab8b793f60f4c77b9d837fa3693.png"},function(e,t,i){e.exports=i.p+"assets/d0797776e88d180a0467e06d6899a8ae.png"},function(e,t,i){e.exports=i.p+"assets/5fee96579fcfd0ddcb7e4d454cf0be76.png"},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(382),a=i(8),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(){function e(t){var i=t.game;r(this,e),this.game=i,this.textObjects=[],this.currentLang=navigator.language===a.Q?a.Q:a.P,this.translations=s.a}return n(e,[{key:"setLang",value:function(e){var t=this;this.currentLang=e,this.textObjects.forEach(function(e){var i=e.inst,r=e.text;i.setText(t.getTranslation(r))})}},{key:"createText",value:function(e,t,i,r){var s=this.game.add.text(e,t,this.getTranslation(i),r);return this.textObjects.push({inst:s,text:i}),s}},{key:"getTranslation",value:function(e){return this.translations[e][this.currentLang]}},{key:"clear",value:function(){this.textObjects=[]}}]),e}();t.a=o},function(e,t,i){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s,a=i(8);t.a=(s={},r(s,a.u,{en:"Peaceful protest",ru:"Мирная акция протеста"}),r(s,a.C,{en:"> Level 01",ru:"> Уровень 01"}),r(s,a.D,{en:"> Level 02",ru:"> Уровень 02"}),r(s,a.B,{en:"How to play?",ru:"Как играть?"}),r(s,a.A,{en:"Controls",ru:"Управление"}),r(s,a.z,{en:"<   Back",ru:"<   Назад"}),r(s,a.n,{en:"move around",ru:"двигаться"}),r(s,a.p,{en:"run",ru:"бегать"}),r(s,a.o,{en:"show poster",ru:"показать плакат"}),r(s,a.y,{en:"Fill the protest scale before your time runs out",ru:"Заполните шкалу протеста на 100%, пока не вышло время"}),r(s,a.w,{en:"Show your poster to people around you to cheer them up",ru:"Показывайте плакат другим людям, чтобы поднять их настроение"}),r(s,a.v,{en:"Show your poster to journalists for several seconds to call out for more people",ru:"Показывайте плакат журналистам несколько секунд, чтобы позвать больше людей"}),r(s,a.x,{en:"Cops will chase you and others for showing posters",ru:"Полицейские вас арестуют, если поймают с плакатом"}),r(s,a.L,{en:"Protest meter",ru:"Шкала протеста"}),r(s,a.J,{en:"Loading",ru:"Загрузка"}),r(s,a.K,{en:"Pause",ru:"Пауза"}),r(s,a.t,{en:"You did it!",ru:"Митинг удался!"}),r(s,a.q,{en:"They got you, pal",ru:"Суши сухари, дружище"}),r(s,a.s,{en:"Time is out!",ru:"Время вышло!"}),r(s,a.r,{en:"You failed :(",ru:"Ты слил протест :("}),r(s,a.H,{en:"Your time",ru:"Время"}),r(s,a.I,{en:"Total protesters",ru:"Всего протестующих"}),r(s,a.E,{en:"Active",ru:"Осталось на митинге"}),r(s,a.F,{en:"Arrested",ru:"Арестовано"}),r(s,a.G,{en:"Left home",ru:"Ушло домой"}),s)},function(e,t,i){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function s(e){return Array.isArray(e)?e:Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=i(8),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),h=function(){function e(){a(this,e)}return o(e,[{key:"init",value:function(e){this.mz={config:e,objects:{textProgress:null}}}},{key:"preload",value:function(){var e=this;this.game.stage.backgroundColor="#000",this.mz.config.assets.forEach(function(t){var i,a,n,o=s(t),h=o[0],l=o.slice(1);switch(h){case"pack":(i=e.load).pack.apply(i,r(l));break;case"spritesheet":(a=e.load).spritesheet.apply(a,r(l));break;case"image":(n=e.load).image.apply(n,r(l))}}),this.mz.objects.textLoading=this.game.add.text(this.game.world.centerX-5,this.game.world.centerY,this.game.mz.i18n.getTranslation(n.J),{font:"26px Arial",fill:"#fff"}),this.mz.objects.textLoading.anchor.set(1,.5),this.mz.objects.textProgress=this.game.add.text(this.game.world.centerX+5,this.game.world.centerY,"0 %",{font:"26px Arial",fill:"#fff"}),this.mz.objects.textProgress.anchor.set(0,.5)}},{key:"loadUpdate",value:function(){this.mz.objects.textProgress.setText(this.game.load.progress+" %")}},{key:"create",value:function(){var e;(e=this.state).start.apply(e,r(this.mz.config.nextState))}}]),e}();t.a=h},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(385),a=i(124),n=i(8),o=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),l=function(){function e(){r(this,e)}return h(e,[{key:"preload",value:function(){this.game.stage.backgroundColor="#000"}},{key:"create",value:function(){var e=this;this.game.world.resize(this.game.width,this.game.height),this.title=this.game.mz.i18n.createText(this.game.width/2,this.game.height/6,n.u,{fill:"#fff"}),this.title.anchor.set(.5);var t=this.game.height/3,i=Math.min(this.game.height/7,70);this.menu=[[n.C,this.handleClickPlay.bind(this,"level1")],[n.B,this.handleClickHelp.bind(this)],[n.A,this.handleClickControls.bind(this)]].map(function(r,s){var a=o(r,2),n=a[0],h=a[1];return[e.game.mz.i18n.createText(40,s*i+t,n,{font:"22px Arial",fill:"#fff"}),h]}),this.langButton=this.game.add.button(this.game.world.width-10,0,"langButtons",this.handleClickLang.bind(this)),this.langButton.anchor.set(1,0),this.game.input.onDown.add(this.handleClickMenu,this)}},{key:"update",value:function(){this.langButton.frame=this.game.mz.i18n.currentLang===n.Q?1:0}},{key:"handleClickPlay",value:function(e){this.state.start("Loading",!0,!1,{assets:[["pack","levelCommon",null,a.a],["pack",e,null,a.a]],nextState:["Game",!0,!1,s.a[e]]})}},{key:"handleClickLang",value:function(){this.game.mz.i18n.setLang(this.game.mz.i18n.currentLang===n.Q?n.P:n.Q)}},{key:"handleClickMenu",value:function(){var e=this;this.menu.some(function(t){var i=o(t,2),r=i[0],s=i[1];if(r.getBounds().contains(e.game.input.x,e.game.input.y))return e.game.input.onDown.remove(e.handleClickMenu,e),s(),!0})}},{key:"handleClickHelp",value:function(){this.state.start("Help",!0,!1)}},{key:"handleClickControls",value:function(){this.state.start("Controls",!0,!1)}}]),e}();t.a=l},function(e,t,i){"use strict";t.a={level1:{id:"level1",worldWidth:1200,worldHeight:800,duration:180,winningThreshold:100,cops:{count:[[4,0],[50,1],[90,4],[100,5]],speed:{value:50,running:1.7},fov:{distance:150,angle:100}},press:{count:[[4,0],[50,1],[60,2],[100,3]],speed:{value:50},fov:{distance:150,angle:100},duration:5},protesters:{count:{start:10,max:50,add:8},speed:{value:60},mood:.7,moodUp:.001,moodDown:1e-4,poster:{drop:.3,alive:20}},player:{speed:{value:100,withPoster:.6,running:1.5},radius:120,stamina:100,staminaCooldown:5,powerUp:.1,powerDown:.01},swat:{count:5,speed:{value:200},frequency:15e3,scoreThreshold:60}},level2:{id:"level2",worldWidth:800,worldHeight:800,duration:240,winningThreshold:75,cops:{count:[[40,1],[50,2],[60,3],[90,4],[100,5]],speed:{value:60,running:1.8},fov:{distance:150,angle:120}},swat:{count:5,speed:{value:200},frequency:5e3,scoreThreshold:10},press:{count:5,speed:{value:50},fov:{distance:100,angle:100},duration:5},protesters:{count:{start:20,max:60,add:10},max:60,speed:{value:60},mood:.25,moodUp:.002,moodDown:1e-4,poster:{drop:.12,alive:20}},player:{speed:{value:100,withPoster:.6,running:1.5},radius:120,stamina:200,staminaCooldown:5,powerUp:.1,powerDown:.01}}}},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(){r(this,e)}return a(e,[{key:"preload",value:function(){this.game.stage.backgroundColor="#000"}},{key:"create",value:function(){var e=this,t=this.game.width/15;this.back=this.game.add.text(t,this.game.height/15,this.game.mz.i18n.getTranslation(s.z),{fill:"#fff"});var i=this.game.add.group(),r=0,a=this.game.height/30,n=Math.min(22,Math.round(this.game.height/19));[s.y,s.w,s.v,s.x].forEach(function(s,o){var h=e.game.add.text(t,r,o+1+". "+e.game.mz.i18n.getTranslation(s)+".",{font:n+"px Arial",fill:"#fff",wordWrap:!0,wordWrapWidth:e.game.width-2*t});r+=h.height+a,i.add(h)}),i.y=(this.game.height+this.back.bottom-r+a)/2,this.game.input.onDown.add(this.handleClickBack,this)}},{key:"handleClickBack",value:function(){if(this.back.getBounds().contains(this.game.input.x,this.game.input.y))return this.game.input.onDown.remove(this.handleClickBack,this),this.state.start("StartMenu",!0,!1),!0}}]),e}();t.a=n},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o=function(){function e(){r(this,e)}return n(e,[{key:"preload",value:function(){this.game.stage.backgroundColor="#000"}},{key:"create",value:function(){var e=this;this.back=this.game.add.text(40,this.game.height/15,this.game.mz.i18n.getTranslation(s.z),{fill:"#fff"});var t=this.game.height/3.4,i=Math.min(100,this.game.height/3.8);[["Move",s.n],["Run",s.p],["Poster",s.o]].forEach(function(r,s){var n=a(r,2),o=n[0],h=n[1];e.game.add.sprite(e.game.width/4,s*i+t,"help"+o).anchor.set(.5),e.game.add.text(e.game.width/2,s*i+t,e.game.mz.i18n.getTranslation(h),{font:"20px Arial",fill:"#fff"}).anchor.set(0,.5)}),this.game.input.onDown.add(this.handleClickBack,this)}},{key:"handleClickBack",value:function(){if(this.back.getBounds().contains(this.game.input.x,this.game.input.y))return this.game.input.onDown.remove(this.handleClickBack,this),this.state.start("StartMenu",!0,!1),!0}}]),e}();t.a=o},function(e,t,i){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function s(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=i(136),o=i(390),h=i(391),l=i(392),u=i(140),c=i(393),p=(i(394),i(395)),d=i(396),m=i(398),f=i(399),g=i(400),y=i(138),v=i(419),b=i(420),w=i(421),k=i(8),x=(i(141),i(8)),z=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},j=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),O=function(){function e(){a(this,e)}return j(e,[{key:"init",value:function(e){window.game=this,this.collider=new g.a({game:this.game,gameObject:this,scale:20}),this.mz={level:e,gameEnded:!1,screenAttacked:!1,score:0,timePassed:0,protesters:{alive:0,arrested:0,revived:0,left:0,toRevive:e.protesters.count.start,meanMood:e.protesters.mood},cops:{alive:0},postersToRevive:[],events:{keys:{},fieldClickHandler:null},timers:{swat:null,screen:null,resize:null,fight:null},objects:{star:null,player:null,swat:null,shield:null,bgTile:null,interface:null,audio:{},pauseMenu:null,endMenu:null,screenAttack:null,mask:null},arrays:{protesters:[],cops:[],press:[],borders:[],droppedPosters:[],wagons:[],enterWagons:[],awaitWagons:[]},groups:{d:null,cars:null,droppedPosters:null,copsFOV:null,pressFOV:null,playerFOV:null,npcProtesters:null,levelObjects:null,player:null},zoomLevel:-1,advices:{space_pozor:!1,shift_run:!1},tweet:null},this.mz.score=0}},{key:"create",value:function(){var e=this;this.mz.tweet=new b.a(this.game),this.mz.score=0,this.game.stage.backgroundColor="#ccc",this.game.sound.mute=!0,this.game.world.resize(this.mz.level.worldWidth,this.mz.level.worldHeight),this.mz.objects.bgTile=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"meeting_map"),this.mz.objects.bgTile.fixedToCamera=!0,this.mz.objects.audio.theme=this.game.add.audio("theme"),this.mz.objects.audio.theme.loopFull(.1),this.mz.objects.audio.audioPunch=[this.game.add.audio("punch01"),this.game.add.audio("punch02")],this.mz.objects.audio.random=[this.game.add.audio("croud")],this.mz.objects.audio.applause=this.game.add.audio("applause"),this.mz.objects.audio.boo=this.game.add.audio("boo"),this.mz.objects.audio.pick=this.game.add.audio("pick"),this.mz.groups.playerFOV=this.game.add.group(),this.mz.groups.pressFOV=this.game.add.group(),this.mz.groups.copsFOV=this.game.add.group(),this.mz.groups.levelObjects=this.game.add.group(),this.mz.groups.droppedPosters=this.game.add.group(),this.mz.groups.cars=this.game.add.group(),this.mz.groups.d=this.game.add.group(),this.mz.groups.player=this.game.add.group(),this.mz.groups.npcProtesters=this.game.add.group(),this.mz.levelObjects={};for(var t in w.a)!function(t){var i=w.a[t],r=(i.speed,i.personalMatrix,i.sprite),a=i.positions,n=(i.objectClass,i.immovable),o=i.group;s(i,["speed","personalMatrix","sprite","positions","objectClass","immovable","group"]);e.mz.levelObjects[t]=a.map(function(i,s){var a=i.x,h=i.y,l=i.angle,u=e.game.add.sprite(a,h,r,0);return u.spriteName=r+s,l&&(u.angle=l),e.game.physics.arcade.enable(u),u.body.setSize(u.height,u.width,-u.height,0),e.mz.groups[o].add(u),n&&(u.body.immovable=!0),e.collider.addEntity({sprite:u,object:e.game}),"paddyWagon"===t&&(e.mz.groups.cars.add(u),e.mz.arrays.awaitWagons.push(u)),u})}(t);this.mz.objects.player=this.createPrefab(n.a,T({x:this.game.world.centerX,y:this.game.world.centerY,fovGroup:this.mz.groups.playerFOV},this.mz.level.player,{onDropPoster:this.handleDropPoster.bind(this)})),this.game.camera.follow(this.mz.objects.player.sprite),this.mz.groups.d.add(this.mz.objects.player.sprite),this.createCops(),this.mz.timers.screen=this.game.time.create(!1),this.mz.timers.resize=this.game.time.create(!1),this.mz.timers.fight=this.game.time.create(!1),this.mz.level.swat&&(this.mz.objects.swat=new c.a(T({gameObject:this,game:this.game},this.mz.level.swat,{group:this.mz.groups.d})),this.mz.timers.swat=this.game.time.create(!1)),this.onFinishShooting=this.handleFinishShooting.bind(this);for(var i=this.getPressRequiredNumber(),r=this.mz.arrays.press.length;r<i;r++){var a=this.createPrefab(l.a,T({},this.getRandomCoordinates(),{fov:{group:this.mz.groups.pressFOV,distance:this.mz.level.press.fov.distance,angle:this.mz.level.press.fov.angle},speed:this.mz.level.press.speed,shootingDuration:this.mz.level.press.duration,cooldownDuration:this.mz.level.press.duration*i*2,onFinishShooting:this.onFinishShooting,spriteName:"journalist"+r}));this.mz.arrays.press.push(a.sprite),this.mz.groups.d.add(a.sprite),a.setMode(k.O)}this.createProtesters(),this.mz.objects.interface=new d.a({game:this.game,onTogglePoster:function(){e.mz.objects.player.togglePoster()}}),this.updateScore(),this.mz.objects.pauseMenu=new m.a({game:this.game});var o=this.game.add.sprite(0,0);o.fixedToCamera=!0,o.scale.set(this.game.width,this.game.height),o.inputEnabled=!0,o.input.priorityID=1,o.events.onInputDown.add(this.handleTap,this),this.mz.events.fieldClickHandler=o,this.game.onPause.add(this.handlePause,this),this.game.onResume.add(this.handlePause,this),this.game.input.onDown.add(this.handleUnpause,this),this.mz.events.keys.esc=this.game.input.keyboard.addKey(Phaser.Keyboard.ESC),this.game.camera.setBoundsToWorld(),this.customCamera=new v.a(this.game.camera,this.game),y.a.setGame(this.game),y.a.show("space_pozor")}},{key:"update",value:function(){var e=this;this.mz.objects.bgTile.tilePosition.set(-this.game.camera.x,-this.game.camera.y),this.collider.update(),this.mz.gameEnded||this.playRandomSound(),this.mz.objects.player.update();var t=this.mz.protesters.meanMood;this.mz.protesters.meanMood=0,this.mz.protesters.alive=0;var i=this.mz.arrays.protesters.filter(function(e){return e.mz.showPoster&&e.mz.isAgitator});this.mz.objects.player.showPoster&&i.push(this.mz.objects.player.sprite);for(var s=0;s<this.mz.arrays.protesters.length;s++){var a=this.mz.arrays.protesters[s];if(a.alive){a.mz.update();var n=!1,o=!0,h=!1,u=void 0;try{for(var c,p=i[Symbol.iterator]();!(o=(c=p.next()).done);o=!0){var d=c.value;if(this.getDistanceSq(a,d)<=this.mz.objects.player.radius.actualSq){n=!0;break}}}catch(e){h=!0,u=e}finally{try{!o&&p.return&&p.return()}finally{if(h)throw u}}a.mz.toggleCheering(!this.mz.gameEnded&&n),this.mz.protesters.alive++,this.mz.protesters.meanMood+=a.mz.mood}else if(0!==this.mz.protesters.toRevive){var m=this.game.math.clamp(t,this.mz.level.protesters.mood,(this.mz.level.winningThreshold-1)/100);this.reviveProtester({sprite:a,mood:m}),this.mz.protesters.alive++,this.mz.protesters.meanMood+=m}}this.mz.protesters.toRevive=0,this.mz.protesters.meanMood=0!==this.mz.protesters.alive?this.mz.protesters.meanMood/this.mz.protesters.alive:0,this.mz.gameEnded||this.mz.objects.interface.update({score:this.mz.score,protestersAlive:this.mz.protesters.alive,protestersTotal:this.mz.level.protesters.count.max,meanMood:this.mz.protesters.meanMood}),this.mz.arrays.press.forEach(function(t){var i=t.mz,r=null;!e.mz.gameEnded&&i.FOV.isActive&&e.mz.objects.player.showPoster&&i.FOV.containsPoint(e.mz.objects.player.sprite.body.center)&&(r=e.mz.objects.player.sprite),r?i.setMode(k.N,{target:r}):i.mode!==k.O&&i.mode!==x.M&&i.setMode(k.O),i.update()}),this.mz.objects.swat&&((this.mz.score>=this.mz.level.swat.scoreThreshold||this.mz.gameEnded)&&this.mz.objects.swat.mode===k._1&&!this.mz.timers.swat.running?(this.mz.timers.swat.add(this.mz.level.swat.frequency,this.launchSWAT,this),this.mz.timers.swat.start()):this.mz.timers.swat.running&&this.mz.score<this.mz.level.swat.scoreThreshold&&this.mz.timers.swat.stop(!0),this.mz.objects.swat.update());var f=this.getCopsRequiredNumber();this.mz.cops.alive<this.mz.arrays.cops.length&&this.mz.arrays.wagons.length&&f>this.mz.cops.alive&&(this.reviveCops(f-this.mz.cops.alive),this.mz.cops.alive=f),f>this.mz.cops.alive&&0===this.mz.arrays.wagons.length&&0===this.mz.arrays.enterWagons.length&&this.handleEnterWagon(this.mz.arrays.awaitWagons[0],300,0),this.handleEnteringWagons();for(var g=this.getPressRequiredNumber(),y=this.mz.arrays.press.length;y<g;y++){var v=this.createPrefab(l.a,T({},this.getRandomCoordinates(),{fov:{group:this.mz.groups.pressFOV,distance:this.mz.level.press.fov.distance,angle:this.mz.level.press.fov.angle},speed:this.mz.level.press.speed,shootingDuration:this.mz.level.press.duration,cooldownDuration:this.mz.level.press.duration*g*2,onFinishShooting:this.onFinishShooting,spriteName:"journalist"+y}));this.mz.arrays.press.push(v.sprite),this.mz.groups.d.add(v.sprite),v.setMode(k.O)}for(var b=0;b<this.mz.cops.alive;b++){var w=this.mz.arrays.cops[b],j=w.mz;if(j.mode===k.a&&this.mz.objects.player.mode!==k.R&&this.mz.objects.player.mode!==k.T&&this.mz.objects.player.mode!==k.U){var O=this.mz.objects.player.sprite.body.center;Math.abs(w.body.center.x-O.x)+Math.abs(w.body.center.y-O.y)<40&&(this.mz.objects.player.setMode(k.R),j.setMode(x.c))}if(j.mode!==k.a&&j.mode!==k.b&&j.mode!==x.c&&j.mode!==x.e){j.attractionPoint=T({},this.mz.objects.player.sprite.body.center);var P=0;this.mz.objects.player.showPoster&&(P+=.2,this.mz.arrays.press.forEach(function(e){e.mz.mode===k.N&&(P+=.4)})),j.attractionStrength=Math.min(1,P*this.mz.objects.player.power);for(var A=null,M=1/0,_=0;_<=this.mz.arrays.protesters.length;_++){var C=_===this.mz.arrays.protesters.length?this.mz.objects.player:this.mz.arrays.protesters[_].mz;if(C.sprite.alive&&C.mode!==k.U&&j.FOV.containsPoint(C.sprite.body.center)&&(C.sprite===j.target||C.showPoster)){var S=this.getDistanceSq(w.body.center,C.sprite.body.center);C.sprite===j.target&&(S*=.75),S<M&&(A=C.sprite,M=S)}}A?j.setMode(k.d,{target:A}):j.mode!==k.f&&j.setMode(k.f)}j.update()}var W=[].concat(r(this.mz.arrays.protesters),[this.mz.objects.player.sprite]);this.mz.objects.star&&W.push(this.mz.objects.star.sprite);var E=!0,D=!1,R=void 0;try{for(var N,F=W[Symbol.iterator]();!(E=(N=F.next()).done);E=!0){var B=N.value;if(B.alive&&B.mz.mode!==k.U){for(var H=B.getBounds(),G=0;G<this.mz.arrays.cops.length;G++){var I=this.mz.arrays.cops[G];I.alive&&I.mz.target===B&&Phaser.Rectangle.intersects(H,I.getBounds())&&B.mz.mode!==k.R&&I.mz.mode!==x.e&&I.mz.mode!==x.c&&this.proceedToJail(B,I)}if(this.mz.objects.swat)for(var L=0;L<this.mz.objects.swat.sprites.length;L++){var V=this.mz.objects.swat.sprites[L];0!==V.children.length||V.x<=0||V.x>=this.game.world.width||!Phaser.Rectangle.intersects(H,V.getBounds())||this.arrest(B,V)}}}}catch(e){D=!0,R=e}finally{try{!E&&F.return&&F.return()}finally{if(D)throw R}}if(this.mz.objects.player.mode!==k.U&&!this.mz.gameEnded)for(var U=0;U<this.mz.arrays.droppedPosters.length;U++){var q=this.mz.arrays.droppedPosters[U];q.sprite.alive&&(Phaser.Rectangle.intersects(q.sprite.getBounds(),this.mz.objects.player.sprite.getBounds())&&(this.mz.objects.audio.pick.play("",0,.25),this.mz.objects.player.powerUp(),q.kill()))}var Y=function(t){return!(t&&t.mz&&t.mz.mode&&t.mz.mode===k.V&&t.mz.following&&t.mz.following.target===e.mz.objects.player.sprite)},K=function(e){return function(t,i){return!(t.mz.target===i&&t.mz.mode===e)}};this.game.physics.arcade.collide(this.mz.objects.player.sprite,this.mz.arrays.protesters,null,function(e,t){return K(x.X)(t,e)&&Y(e)&&Y(t)}),this.game.physics.arcade.collide(this.mz.levelObjects.paddyWagon,this.mz.objects.player.sprite),this.game.physics.arcade.collide(this.mz.levelObjects.paddyWagon,this.mz.arrays.protesters),this.mz.objects.star&&this.game.physics.arcade.collide(this.mz.objects.player.sprite,this.mz.objects.star.sprite),this.game.physics.arcade.collide(this.mz.arrays.cops,this.mz.arrays.protesters,null,K(k.d)),this.game.physics.arcade.collide(this.mz.arrays.cops,this.mz.objects.player,null,K(k.d)),this.mz.arrays.droppedPosters.forEach(function(e){e.sprite.alive&&e.update()}),this.mz.postersToRevive.forEach(this.createPoster,this),this.mz.postersToRevive=[],this.mz.groups.d.sort("y",Phaser.Group.SORT_ASCENDING),this.mz.gameEnded||this.checkWin(),this.mz.events.keys.esc.justUp&&(this.game.paused=!this.game.paused),this.mz.objects.star&&this.mz.objects.star.update();for(var X=[[30,1,2e3,800]],Q=-1,J=0;J<X.length;J++){var Z=z(X[J],4),$=Z[0];Z[1],Z[2],Z[3];this.mz.protesters.alive>$&&(Q=J)}if(this.mz.zoomLevel<Q){var ee=z(X[Q],4),te=(ee[0],ee[1],ee[2]),ie=ee[3];this.game.world.resize(te,ie)}this.mz.screenAttacked&&(console.log("sprite position",this.mz.objects.player.sprite.x,this.mz.objects.player.sprite.y),this.mz.objects.screenAttack.clear().beginFill(6799481,.95).moveTo(0,0).arc(this.mz.objects.player.sprite.x,this.mz.objects.player.sprite.y,50,0,2*Math.PI).lineTo(0,0).lineTo(0,this.game.world.height).lineTo(this.game.world.width,this.game.world.height).lineTo(this.game.world.width,0).lineTo(0,0).endFill())}},{key:"render",value:function(){}},{key:"handleTap",value:function(e,t){var i={x:t.x+this.game.camera.x,y:t.y+this.game.camera.y},r=this.mz.objects.player;r.resetClickSpeed(),r.moveTo(i,{callback:function(){return r.resetClickSpeed(!0)}})}},{key:"handleProtesterLeft",value:function(){this.mz.protesters.left++}},{key:"handleDropPoster",value:function(e){this.mz.postersToRevive.push(e)}},{key:"handleFinishShooting",value:function(e){this.mz.protesters.toRevive+=this.mz.level.protesters.count.add,this.increaseScore(this.mz.level.protesters.count.add,e.sprite)}},{key:"handlePause",value:function(){this.game.paused?this.mz.objects.pauseMenu.revive():this.mz.objects.pauseMenu.kill()}},{key:"handleUnpause",value:function(){this.game.paused&&this.mz.objects.pauseMenu.replayButton.getBounds().contains(this.game.input.x,this.game.input.y)&&(this.game.paused=!1)}},{key:"updateScore",value:function(){this.mz.objects.interface.updateScore(this.mz.score)}},{key:"createCops",value:function(){var e=this.mz.level.cops.count[this.mz.level.cops.count.length-1][1];this.mz.cops.alive=this.getCopsRequiredNumber();for(var t=0;t<e;t++){var i=void 0,r=void 0;if(t<this.mz.cops.alive){var s=this.pickRandomWagon();i=Math.round(s.body.center.x)+60,r=s.y+s.body.height+15}else{var a=this.getRandomCoordinates();i=a.x,r=a.y}var n=this.createPrefab(h.a,{x:i,y:r,alive:t<this.mz.cops.alive,fov:{group:this.mz.groups.copsFOV,distance:this.mz.level.cops.fov.distance,angle:this.mz.level.cops.fov.angle},speed:this.mz.level.cops.speed,spriteName:"cop"+t});this.mz.arrays.cops.push(n.sprite),this.mz.groups.d.add(n.sprite),t<this.mz.cops.alive&&n.setMode(k.f)}}},{key:"reviveCops",value:function(e){for(var t=0;t<e;t++){var i=t+this.mz.cops.alive;this.mz.arrays.cops[i].mz.revive(Boolean(i%2))}}},{key:"getCopsRequiredNumber",value:function(){for(var e=0,t=0;t<this.mz.level.cops.count.length;t++)if(this.mz.score<=this.mz.level.cops.count[t][0]){e=this.mz.level.cops.count[t][1];break}return e}},{key:"getPressRequiredNumber",value:function(){for(var e=0,t=0;t<this.mz.level.press.count.length;t++)if(this.mz.score<=this.mz.level.press.count[t][0]){e=this.mz.level.press.count[t][1];break}return e}},{key:"createProtesters",value:function(){for(var e=this.mz.level.protesters.count.max,t=this.handleDropPoster.bind(this),i=this.handleProtesterLeft.bind(this),r=0;r<e;r++){var s=this.createPrefab(o.a,T({},this.getRandomCoordinates(),{group:this.mz.groups.d,speed:this.mz.level.protesters.speed,spriteKey:"protester_sprite",spriteName:"protester"+r,mood:this.mz.level.protesters.mood,moodUp:this.mz.level.protesters.moodUp,moodDown:this.mz.level.protesters.moodDown,dropPoster:this.mz.level.protesters.poster.drop,onLeft:i,onDropPoster:t}));this.mz.arrays.protesters.push(s.sprite)}}},{key:"randomOffscreenCoords",value:function(){var e=this.game.rnd.between(0,100);return{x:0===this.game.rnd.between(0,1)?-100-e:this.game.world.width+100+e,y:this.getRandomCoordinateY()}}},{key:"reviveProtester",value:function(e){var t=e.sprite,i=e.mood;t.mz.revive(T({},this.randomOffscreenCoords(),{nextCoords:this.getRandomCoordinates(),mood:i})),this.mz.protesters.toRevive--,this.mz.protesters.revived++}},{key:"beatUpProtester",value:function(e){e.body.enable=!1,e.mz.viewSprite.damage(.1),this.playRandomPunch()}},{key:"createPoster",value:function(e){for(var t=!1,i=0;i<this.mz.arrays.droppedPosters.length;i++){var r=this.mz.arrays.droppedPosters[i];if(!r.sprite.alive){r.revive(e),t=!0;break}}t||this.mz.arrays.droppedPosters.push(new p.a(T({game:this.game,group:this.mz.groups.droppedPosters},e,{alive:this.mz.level.protesters.poster.alive})))}},{key:"proceedToJail",value:function(e,t){var i=this,r=null,s=1/0;this.mz.groups.cars.forEach(function(e){var a={x:(e.body.x+e.body.width)/2+60,y:e.body.y+e.body.height+20},n=i.getDistanceSq(t,a);n<s&&(r=a,s=n)}),this.arrest(e,t),t.mz.setMode(k.a,{jailCoords:r})}},{key:"arrest",value:function(e,t){this.beatUpProtester(e),t.addChild(e),"player"===e.name&&this.game.camera.follow(t),e.mz.setMode(k.U,{x:(0===t.body.velocity.x?this.game.rnd.sign():-Math.sign(t.body.velocity.x))*e.body.halfWidth,y:e.body.halfHeight,by:t.mz}),"player"!==e.name&&this.mz.protesters.arrested++}},{key:"unarrest",value:function(e){for(var t=null,i=0;i<e.children.length;i++)if(e.getChildAt(i)!==e.mz.viewSprite&&e.getChildAt(i).mz){t=e.getChildAt(i);break}if(console.log("protester sprite",t),t.mz.mood=.1,e.removeChild(t),this.mz.groups.d.add(t),"player"===t.name&&this.game.camera.follow(e),"player"!==t.name){this.mz.protesters.arrested--,t.mz.kill(),t.body.enable=!0;var r=e.x+30,s=e.y+30;t.mz.revive({x:r,y:s,nextCoords:{x:r,y:s}}),t.visible=!0;var a=n.a.instance.slots.take(this);a&&t.mz.setMode(k.V,{slot:a})}console.log("protester",t)}},{key:"launchSWAT",value:function(){this.mz.timers.swat.stop(!0),this.mz.objects.audio.boo.play();var e=0===this.game.rnd.between(0,1)?"ltor":"rtol",t={x:"ltor"===e?-100:this.game.world.width+100,y:this.getRandomCoordinateY()},i=[];if(this.mz.objects.star&&this.mz.objects.star.sprite.alive){var r=this.mz.objects.star.sprite.body.center,s=r.x,a=r.y;i.push({x:s,y:a})}i.push({x:"ltor"===e?this.game.world.width+100:-100,y:this.getRandomCoordinateY()}),this.mz.objects.swat.setMode(k._2,{start:t,targets:i})}},{key:"launchShield",value:function(){this.mz.objects.shield.setMode(k.Z,{y:this.game.height/2+this.game.camera.y})}},{key:"checkWin",value:function(){this.mz.protesters.alive<=0?this.endGame(k.h):this.mz.score>=100?this.endGame(k.j):this.mz.objects.player.mode!==k.U&&this.mz.objects.player.sprite.alive||this.endGame(k.g)}},{key:"endGame",value:function(e){if(this.mz.gameEnded=!0,this.mz.objects.audio.theme.fadeOut(2e3),this.mz.objects.endMenu=new f.a({game:this.game,mode:e,score:this.mz.objects.interface.score.group,stats:{time:this.mz.timePassed,alive:this.mz.protesters.alive,arrested:this.mz.protesters.arrested,revived:this.mz.protesters.revived,left:this.mz.protesters.left}}),this.game.camera.unfollow(),this.mz.objects.interface.kill(),this.mz.events.fieldClickHandler.kill(),this.game.onPause.removeAll(),this.game.onResume.removeAll(),this.mz.objects.player.freeze(),this.game.input.keyboard.removeKey(Phaser.Keyboard.ESC),this.game.input.onDown.remove(this.handleUnpause,this),e===k.j)this.mz.objects.audio.applause.play("",0,.25),this.mz.arrays.protesters.forEach(function(e){e.mz.moodUp(1)});else switch(this.mz.objects.audio.boo.play(),e){case k.i:this.mz.arrays.protesters.forEach(function(e){e.mz.moodDown(1)});break;case k.h:case k.g:}}},{key:"playRandomSound",value:function(){0===this.game.rnd.between(0,1/this.mz.objects.audio.random.length*600)&&this.game.rnd.pick(this.mz.objects.audio.random).play("",0,.25)}},{key:"playRandomPunch",value:function(){this.game.rnd.pick(this.mz.objects.audio.audioPunch).play("",0,.25)}},{key:"getDistanceSq",value:function(e,t){return this.game.math.distanceSq(e.x,e.y,t.x,t.y)}},{key:"checkContainWagon",value:function(e){var t=e.x,i=e.y,r=!0,s=!1,a=void 0;try{for(var n,o=this.mz.levelObjects.paddyWagon[Symbol.iterator]();!(r=(n=o.next()).done);r=!0){var h=n.value;if(console.log(h),h.getBounds().contains(t,i))return!0}}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return!1}},{key:"getRandomCoordinates",value:function(){for(var e={x:this.getRandomCoordinateX(),y:this.getRandomCoordinateY()};this.checkContainWagon(e);)e={x:this.getRandomCoordinateX(),y:this.getRandomCoordinateY()};return e}},{key:"getRandomCoordinateX",value:function(){return this.game.math.clamp(this.game.world.randomX,k.k.left,this.game.world.width-k.k.right)}},{key:"getRandomCoordinateY",value:function(){return this.game.math.clamp(this.game.world.randomY,k.k.top,this.game.world.height-k.k.bottom)}},{key:"screenAttack",value:function(){this.mz.screenAttacked?(this.mz.timers.screen.stop(),this.mz.timers.screen.removeAll(),this.mz.timers.screen.add(5e3,this.screenAttackStop,this),this.mz.timers.screen.start()):(this.mz.screenAttacked=!0,this.mz.objects.screenAttack=this.game.add.graphics(0,0),this.mz.objects.screenAttack.clear().beginFill(6799481,.95).moveTo(0,0).arc(this.mz.objects.player.sprite.x,this.mz.objects.player.sprite.y,50,0,2*Math.PI).lineTo(0,0).lineTo(0,this.game.world.height).lineTo(this.game.world.width,this.game.world.height).lineTo(this.game.world.width,0).lineTo(0,0).endFill(),this.mz.timers.screen.add(5e3,this.screenAttackStop,this),this.mz.timers.screen.start())}},{key:"screenAttackStop",value:function(){this.mz.objects.screenAttack.destroy(),this.mz.objects.screenAttack=null,this.mz.screenAttacked=!1}},{key:"screenAttackAlpha",value:function(){console.log("attack alpha"),this.mz.objects.screenAttack.alpha-=.005}},{key:"createLevelObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.personalMatrix;return this.collider.addEntity({sprite:e,object:{sprite:e},personalMatrix:i}),game}},{key:"createPrefab",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.personalMatrix,s=this.collider.moveToFactory(),a={game:this.game,GameObject:this,moveTo:s},n=new e(T({},a,t));return this.collider.addEntity({sprite:n.sprite,object:n,personalMatrix:r}),n}},{key:"cameraZoom",value:function(e,t){game.camera.scale.x+=zoomAmount,game.camera.scale.y+=zoomAmount,game.camera.bounds.x=size.x*game.camera.scale.x,game.camera.bounds.y=size.y*game.camera.scale.y,game.camera.bounds.width=size.width*game.camera.scale.x,game.camera.bounds.height=size.height*game.camera.scale.y}},{key:"fightLose",value:function(){for(var e=this,t=0;t<this.mz.cops.alive;t++)!function(t){var i=e.mz.arrays.cops[t];if(i.mz.mode===x.c){var r=null,s=1/0;e.mz.groups.cars.forEach(function(t){var a={x:(t.body.x+t.body.width)/2,y:t.body.y+t.body.height+40},n=e.getDistanceSq(i,a);n<s&&(r=a,s=n)}),i.mz.setMode(k.a,{jailCoords:r})}}(t)}},{key:"increaseScore",value:function(e){this.mz.score+=e,this.updateScore()}},{key:"fightWin",value:function(){for(var e=0;e<this.mz.cops.alive;e++){var t=this.mz.arrays.cops[e],i=t.mz;i.mode===x.c&&(this.unarrest(t),i.setMode(x.e),this.increaseScore(10,t))}}},{key:"handleEnterWagon",value:function(e,t,i){this.game.physics.arcade.moveToXY(e,t,i,60),this.mz.arrays.enterWagons.push({wagon:e,x:t,y:i}),this.mz.arrays.awaitWagons.splice(this.mz.arrays.awaitWagons.findIndex(function(t){return t===e}),1)}},{key:"handleGotPlaceWagon",value:function(e){this.mz.arrays.wagons.push(e),e.body.stop()}},{key:"handleEnteringWagons",value:function(){for(var e=0;e<this.mz.arrays.enterWagons.length;e++){var t=this.mz.arrays.enterWagons[e];if(t){Math.sqrt(Math.pow(t.wagon.x-t.x,2)+Math.pow(t.wagon.y-t.y,2))<20&&(this.handleGotPlaceWagon(t.wagon),this.mz.arrays.enterWagons.splice(e,1),e--)}}}},{key:"pickRandomWagon",value:function(){return this.mz.arrays.wagons.length?this.mz.arrays.wagons[Math.floor(Math.random()*this.mz.arrays.wagons.length)]:null}},{key:"createStar",value:function(){this.mz.objects.star=this.createPrefab(u.a,{}),this.mz.objects.star.setState(u.a.STATE.MOVE_IN)}}]),e}();t.a=O},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a=function(){function e(t,i,s){var a=s.x,n=s.y;r(this,e),this.target=t,this.directionObject=i,this.basePoint=new Phaser.Point(a,n),this.taken=null,this.callback=null,this.point={x:t.x,y:t.y},console.log("constructor slot",this),this.update()}return s(e,[{key:"update",value:function(){var e=this.basePoint,t=this.target,i=t.x,r=t.y;if(this.point=Phaser.Point.rotate(new Phaser.Point(i+e.x,r+e.y),i,r,this.directionObject.direction,!0),Number.isNaN(this.x)||Number.isNaN(this.y))throw new Error("Slot mathematics error")}},{key:"take",value:function(e){this.update(),this.taken=e}},{key:"dismiss",value:function(){this.taken=null}},{key:"x",get:function(){return this.point.x}},{key:"y",get:function(){return this.point.y}},{key:"follow",get:function(){return!0}}]),e}();t.a=a},function(e,t,i){"use strict";function r(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=i(89),h=i(136),l=i(8),u=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),c=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},p=function(e){function t(e){var i=e.group,n=e.mood,o=e.moodDown,h=e.moodUp,l=e.dropPoster,u=e.onLeft,c=r(e,["group","mood","moodDown","moodUp","dropPoster","onLeft"]);s(this,t);var p=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c));return p.group=i,p.group.add(p.sprite),p.progressBar=p.game.add.graphics(),p.sprite.addChild(p.progressBar),p.leavingTimer=p.game.time.create(!1),p.mood=1,p.initialMood=n,p.moodUpValue=h,p.moodDownValue=o,p.shownPoster=!1,p.dropPoster=l,p.isBeingCheeredUp=!1,p.onLeft=u,p.isFollower=!0,p.isFollowing=!1,p.isNOD=!p.isFollower&&Math.random()<.03,p.isAgitator=!p.isFollower&&!p.isNOD&&Math.random()<.1,p.nodDone=!1,p.slot=null,p.sprite.body.setSize(37,37),p.kill(),p}return n(t,e),u(t,[{key:"update",value:function(){if(0!==this.mood||this.leavingTimer.running||this.mode!==l.Y?this.mood>0&&this.leavingTimer.running&&this.leavingTimer.stop(!0):(this.leavingTimer.add(this.game.rnd.between(1e3,5e3),this.leave,this),this.leavingTimer.start()),this.mood>0&&this.mode===l.W&&!this.nodDone&&this.setMode(l.Y),this.mode===l.X&&this.nodDone&&this.setMode(l.W),this.isFollowing||(this.isBeingCheeredUp?this.isNOD?this.nodDone||this.mode==l.X||this.setMode(l.X):(this.updateProgressBar(this.mood),this.moodUp(this.moodUpValue)):this.mood<.75&&(this.moodDown(this.moodDownValue),this.updateProgressBar(0))),this.showPoster=this.mode!==l.U&&this.mood>=.75&&!this.isNOD,this.showPoster&&this.isFollower&&!this.following){var e=h.a.instance.slots.take(this);e&&this.setMode(l.V,{slot:e})}if(this.following&&this.following.target===h.a.instance.sprite&&(this.showPoster=h.a.instance.showPoster),this.showPoster&&!this.shownPoster&&(this.shownPoster=!0,this.GameObject.increaseScore(5,this.sprite)),this.sprite.tint=16777215,this.mood>=.75){var i=(this.mood-.75)/.25*.25;this.sprite.tint=Phaser.Color.RGBArrayToHex([1-i,1,1-i])}else if(this.mood<=.25){var r=.25*(1-this.mood/.25);this.sprite.tint=Phaser.Color.RGBArrayToHex([1,1-r,1-r])}c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}},{key:"handleLeft",value:function(){this.onLeft(),this.kill()}},{key:"setMode",value:function(e){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case l.Y:this.setSpeed(this.speed.value),this.mode===l.W&&this.moveTo(null);var s=r.coords,a=r.phasing,n=void 0!==a&&a;s?this.moveTo(s,{callback:function(){return i.wander()},phasing:n}):this.wander();break;case l.V:this.mode===l.Y&&this.stopWandering();var o=r.slot;this.dismissSlotsTaken(),this.following=o,o.target===h.a.instance.sprite&&this.setSpeed(1.5*this.speed.value),this.moveTo(o,{follow:!0});break;case l.U:this.setSpeed(this.speed.value),this.dismissSlotsTaken(),this.mode===l.Y&&this.stopWandering();break;case l.X:this.setSpeed(this.speed.value),this.mode===l.Y&&this.stopWandering(),console.log(this.GameObject),this.target=this.GameObject.mz.objects.player.sprite,this.moveTo(this.GameObject.mz.objects.player.sprite,{callback:function(){i.nodDone=!0,i.GameObject.screenAttack(),i.target=null,i.moveTo(null)},phasing:!0});break;case l.W:this.setSpeed(this.speed.value),this.mode===l.Y&&this.stopWandering();var u=this.sprite.x<this.game.world.width/2?-100:this.game.world.width+100,p=this.sprite.y;this.moveTo({x:u,y:p},{callback:function(){return i.handleLeft()},shouldStop:function(e,t){var i=e.sprite.body.center;return Math.abs(t.x-i.x)+Math.abs(t.y-i.y)<5}})}c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e,r)}},{key:"wander",value:function(){var e=this;0===this.game.rnd.between(0,10)?this.moveTo(this.getNextCoords(),{callback:function(){return e.wander()}}):(this.stayingTimer.stop(!0),this.stayingTimer.add(this.game.rnd.between(3e3,6e3),this.wander,this),this.stayingTimer.start())}},{key:"leave",value:function(){this.setMode(l.W),this.leavingTimer.stop(!0)}},{key:"toggleCheering",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.isBeingCheeredUp;e!==this.isBeingCheeredUp&&(this.isBeingCheeredUp=e)}},{key:"moodUp",value:function(e){this.mood=Math.min(this.mood+e,1)}},{key:"moodDown",value:function(e){this.mood=Math.max(this.mood-e,0)}},{key:"revive",value:function(e){var i=e.x,r=e.y,s=e.nextCoords,a=e.mood,n=void 0===a?this.initialMood:a;this.sprite.x=i,this.sprite.y=r,this.sprite.body.reset(i,r),this.posterSprite.revive(),this.mood=n,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"revive",this).call(this),this.setMode(l.Y,{coords:s,phasing:!0})}},{key:"reset",value:function(){this.dismissSlotsTaken(),this.isFollower=Math.random()<.1,this.isNOD=!this.isFollower&&Math.random()<.03,this.isAgitator=!this.isFollower&&!this.isNOD&&Math.random()<.1,this.nodDone=!1,this.slot=null,this.shownPoster=!1}},{key:"kill",value:function(){this.group.add(this.sprite),this.stopWandering(),this.reset(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"kill",this).call(this)}},{key:"dismissSlotsTaken",value:function(){this.following&&(this.following.dismiss(),this.following=null)}},{key:"onSlotDismissing",value:function(){this.following=null,this.setMode(l.Y)}}]),t}(o.a);t.a=p},function(e,t,i){"use strict";function r(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=i(62),h=i(139),l=i(8),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},c=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),p=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},d=function(e){function t(e){var i=e.alive,n=e.fov,o=e.x,l=void 0===o?0:o,c=e.y,p=void 0===c?0:c,d=r(e,["alive","fov","x","y"]);s(this,t);var m=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u({x:l,y:p,spriteKey:"cop_sprite"},d)));return m.FOV=new h.a({game:m.game,radius:n.distance,angle:n.angle}),n.group.add(m.FOV.graphics),m.target=null,m.attractionPoint=null,m.attractionStrength=0,m.returnCoords=null,m.sprite.body.immovable=!0,m.sprite.body.setSize(37,37),m.stunTimer=m.game.time.create(!1),i||m.kill(),m}return n(t,e),c(t,[{key:"update",value:function(){var e=this.speed.value;this.mode!==l.d&&this.mode!==l.b||(e*=this.speed.running),this.setSpeed(e),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),this.FOV.update({x:this.sprite.x,y:this.sprite.y,angle:this.sprite.body.angle,mode:this.mode===l.d?l.l:l.m})}},{key:"setMode",value:function(e){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case l.f:var s=r.coords;this.mode===l.d?this.target=null:this.mode!==l.a&&this.mode!==l.c&&this.mode!==l.e||(this.target=null,this.returnCoords=null,this.FOV.revive()),s?this.moveTo(s,{callback:function(){return i.wander()}}):this.wander();break;case l.d:var a=r.target;this.mode===l.f&&this.stopWandering(),this.target=a,this.moveTo(a,{phasing:!0});break;case l.a:var n=r.jailCoords;this.FOV.kill(),this.returnCoords={x:this.sprite.x,y:this.sprite.y},this.moveTo(n,{callback:function(){return i.handleCovoyEnd()},phasing:!0});break;case l.b:var o=r.coords,h=function(){i.FOV.revive(),i.setMode(l.f)};this.moveTo(o,{callback:h,reset:!1,phasing:!0});break;case l.c:this.stopWandering(),this.jailTarget=this.moveTargets,this.moveTo(null);break;case l.e:this.stopWandering(),this.stunTimer.stop(),this.stunTimer.removeAll(),this.stunTween&&this.stunTween.stop(),this.stunTween=this.game.add.tween(this.viewSprite),this.stunTween.to({alpha:0},500,Phaser.Easing.Linear.None,!0,0,500,!0),this.stunTween.start(),this.stunTimer.add(5e3,this.handleRecoverStun,this),this.stunTimer.start()}p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e)}},{key:"handleRecoverStun",value:function(){this.stunTimer.removeAll(),this.stunTimer.stop(),this.stunTween.stop(),this.viewSprite.alpha=1,this.setMode(l.f)}},{key:"handleCovoyEnd",value:function(){for(var e=0;e<this.sprite.children.length;e++)this.sprite.getChildAt(e)!==this.viewSprite&&this.sprite.getChildAt(e).mz.kill();this.setMode(l.f,{coords:this.returnCoords});var t=this.GameObject.mz.tweet.find({type:"arrest"}),i=t[Math.floor(t.length*Math.random())];this.GameObject.mz.tweet.tweet(i.text,"tw_"+i.nickname)}},{key:"handleFightWin",value:function(){}},{key:"wander",value:function(){var e=this;0!==(this.attractionStrength>0?1:this.game.rnd.between(0,2))?this.moveTo(this.getNextCoords(),{callback:function(){return e.wander()}}):(this.stayingTimer.stop(!0),this.stayingTimer.add(this.game.rnd.between(1e3,3e3),this.wander,this),this.stayingTimer.start())}},{key:"getNextCoords",value:function(){var e=void 0,i=this.game.rnd.frac();(1===this.attractionStrength||this.attractionStrength>0&&i<=this.attractionStrength)&&(e={top:Math.min(this.sprite.y,this.attractionPoint.y),right:Math.max(this.sprite.x,this.attractionPoint.x),bottom:Math.max(this.sprite.y,this.attractionPoint.y),left:Math.min(this.sprite.x,this.attractionPoint.x)});var r=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getNextCoords",this).call(this,e);return console.log(r),r}},{key:"revive",value:function(e){var i=this.GameObject.pickRandomWagon(),r=Math.round(i.body.center.x)+100,s=i.y+i.body.height-20;this.sprite.x=r,this.sprite.y=s,this.sprite.body.reset(r,s),this.sprite.body.enable=!0,this.FOV.revive(),p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"revive",this).call(this),this.setMode(l.b,{coords:{x:r,y:s+50}})}},{key:"kill",value:function(){this.target=null,this.stopWandering(),this.FOV.kill(),this.sprite.body.enable=!1,p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"kill",this).call(this)}}]),t}(o.a);t.a=d},function(e,t,i){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=i(62),l=i(139),u=i(8),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},p=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),d=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,r)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(r)},m=function(e){function t(e){var i,o=e.fov,h=e.shootingDuration,p=e.cooldownDuration,d=e.onFinishShooting,m=s(e,["fov","shootingDuration","cooldownDuration","onFinishShooting"]);a(this,t);var f=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c({spriteKey:"press_sprite"},m)));return f.FOV=new l.a({game:f.game,radius:o.distance,angle:o.angle,colors:(i={},r(i,u.m,14540253),r(i,u.l,16777215),i)}),o.group.add(f.FOV.graphics),f.progressBar=f.game.add.graphics(),f.sprite.addChild(f.progressBar),f.sprite.body.setCircle(37),f.shootingTimer=f.game.time.create(!1),f.shootingDuration=1e3*h,f.cooldownTimer=f.game.time.create(!1),f.cooldownDuration=1e3*p,f.onFinishShooting=d,f.target=null,f.following=null,f}return o(t,e),p(t,[{key:"update",value:function(){this.mode===u.N&&this.turnTo(this.target),this.shootingTimer.running?this.updateProgressBar(this.shootingTimer.ms/this.shootingDuration):this.cooldownTimer.running?this.updateProgressBar(this.cooldownTimer.ms/this.cooldownDuration,16711680):this.updateProgressBar(0),this.FOV.update({x:this.sprite.x,y:this.sprite.y,angle:this.sprite.body.angle,mode:this.mode===u.N?u.l:u.m})}},{key:"setMode",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case u.O:this.mode===u.N&&(this.target=null,this.shootingTimer.stop(!0)),this.wander();break;case u.N:var r=i.target;if(this.mode===u.N&&this.target===r)break;this.mode===u.O&&this.stopWandering(),this.target=r,this.shootingTimer.add(this.shootingDuration,this.shootingTimerCallback,this),this.shootingTimer.start();break;case u.M:this.mode===u.O&&this.stopWandering();var s=i.slot;this.following=s,this.moveTo(s,{follow:!0})}d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e)}},{key:"wander",value:function(){var e=this;0!==this.game.rnd.between(0,2)?this.moveTo(this.getNextCoords(),{callback:function(){return e.wander()}}):(this.stayingTimer.stop(!0),this.stayingTimer.add(this.game.rnd.between(1e3,3e3),this.wander,this),this.stayingTimer.start())}},{key:"turnTo",value:function(e){var t=e.x,i=e.y;this.sprite.body.angle=this.game.math.angleBetweenPoints(this.sprite,{x:t,y:i})}},{key:"shootingTimerCallback",value:function(){this.onFinishShooting(this),this.FOV.kill(),this.setMode(u.O),this.shootingTimer.stop(!0),this.cooldownTimer.add(this.cooldownDuration,this.cooldownTimerCallback,this),this.cooldownTimer.start()}},{key:"cooldownTimerCallback",value:function(){this.FOV.revive(),this.cooldownTimer.stop(!0)}},{key:"kill",value:function(){this.cooldownTimer.stop(!0),this.shootingTimer.stop(!0),this.stopWandering(),this.FOV.kill(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"kill",this).call(this)}}]),t}(h.a);t.a=m},function(e,t,i){"use strict";function r(e){return Array.isArray(e)?e:Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){if(0!==e.length){var t=Math.floor(Math.random()*e.length);return t>=e.length&&(t=0),e[t]}}var n=i(8),o=i(140),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},l=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),u=function(){function e(t){var i=t.game,r=t.gameObject,a=t.count,o=t.speed,l=t.group;s(this,e),this.game=i,this.gameObject=r,this.speed=h({current:o.value},o),this.mode=n._1,this.moveTarget=null,this.updateIndex=0,this.sprites=[];for(var u=0;u<a;u++){var c=this.game.add.sprite(-100,-100,"swat",0);c.anchor.set(.5),c.visible=!1,c.mz=this,this.game.physics.arcade.enable(c),this.sprites.push(c),l.add(c)}}return l(e,[{key:"update",value:function(){if(this.mode===n._2){var e=this.sprites[this.sprites.length-1];if(this.game.math.fuzzyEqual(this.game.math.distanceSq(e.x,e.y,this.moveTargets[0].x,this.moveTargets[0].y),0,e.width))this.moveTargets[0].callback&&this.moveTargets[0].callback(),this.moveTargets.shift(),0===this.moveTargets.length?this.setMode(n._1):this.update();else{var t=r(this.moveTargets),i=t[0];t.slice(1);if(this.updateIndex%30==0){var s=this.sprites[0],a=this.game.math.angleBetweenPoints(s,i)+(0===this.updateIndex?1:-1)*this.game.rnd.realInRange(0,.4);this.game.physics.arcade.velocityFromRotation(a,this.speed.current,s.body.velocity)}for(var o=1;o<this.sprites.length;o++){var h=this.sprites[o],l=this.game.math.angleBetweenPoints(h,this.sprites[o-1]);this.game.physics.arcade.velocityFromRotation(l,this.speed.current,h.body.velocity)}59===this.updateIndex?this.updateIndex=0:this.updateIndex++}}}},{key:"setMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case n._1:if(this.mode===n._2){for(var i=0;i<this.sprites.length;i++){for(var s=0;s<this.sprites[i].children.length;s++)this.sprites[i].getChildAt(s).mz.kill();this.sprites[i].removeChildren(),this.sprites[i].visible=!1,this.sprites[i].body.stop()}this.updateIndex=0,this.moveTargets=[]}break;case n._2:if(this.mode===n._1){var a=t.start,o=t.targets,h=a.x,l=a.y;this.moveTargets=o;for(var u=r(o),c=u[0],p=(u.slice(1),c.x>h?-1:1),d=0;d<this.sprites.length;d++){var m=this.sprites[d];m.x=h+d*p*40,m.y=l,m.visible=!0}}}this.mode=e}},{key:"onArrest",value:function(e){if(e instanceof o.a){console.log("Arrested star");var t=a(this.gameObject.mz.levelObjects.paddyWagon),i=this.gameObject.randomOffscreenCoords(),r=i.x,s=i.y,n=function(){return t.body.velocity=new Phaser.Point(r,s)};this.moveTargets.unshift(h({},t.body.center,{callback:n}))}}}]),e}();t.a=u},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),o={ltr:"ltr",rtl:"rtl"};!function(){function e(t){var i=t.game,n=t.speed;r(this,e),this.game=i,this.speed=a({current:n.value},n),this.mode=s._0,this.sprite=this.game.add.sprite(2*this.game.world.width,this.game.world.height/2+this.game.camera.y,"shield"),this.sprite.anchor.set(.5),this.sprite.exist=!1,this.game.physics.arcade.enable(this.sprite),this.sprite.body.immovable=!0,this.direction=o.rtl,this.audio=this.game.add.audio("truck")}n(e,[{key:"update",value:function(){this.mode===s.Z&&(this.direction===o.ltr&&this.sprite.x>=this.game.world.width+this.sprite.width||this.direction===o.rtl&&this.sprite.x<=-this.sprite.width)&&this.setMode(s._0)}},{key:"setMode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case s._0:this.mode===s.Z&&(this.direction=this.direction===o.ltr?o.rtl:o.ltr,this.sprite.kill(),this.sprite.body.stop(),this.audio.stop());break;case s.Z:if(this.mode===s._0){var i=t.y;this.sprite.x=this.direction===o.ltr?-this.game.world.width:2*this.game.world.width,this.sprite.y=i,this.sprite.body.velocity.x=this.speed.current*(this.direction===o.ltr?1:-1),this.sprite.scale.x=this.sprite.scale.y*(this.direction===o.ltr?-1:1),this.audio.loopFull(.25),this.game.camera.shake(.005,3e3)}}this.mode=e}}])}()},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a=function(){function e(t){var i=t.game,s=t.group,a=t.x,n=t.y,o=t.alive;r(this,e),this.game=i,this.aliveTime=1e3*o,this.sprite=this.game.add.sprite(a,n,"poster",0,s),this.sprite.anchor.set(.5),this.sprite.rotation=this.game.rnd.sign()*Math.PI/3,this.livingTimer=this.game.time.create(!1),this.dyingTimer=this.game.time.create(!1),this.launchLivingTimer()}return s(e,[{key:"update",value:function(){this.dyingTimer.running&&(this.sprite.alpha=Math.floor(this.dyingTimer.ms/400)%2)}},{key:"handleLivingTimer",value:function(){this.dyingTimer.add(this.aliveTime/4,this.kill,this),this.dyingTimer.start()}},{key:"launchLivingTimer",value:function(){this.livingTimer.add(3*this.aliveTime/4,this.handleLivingTimer,this),this.livingTimer.start()}},{key:"revive",value:function(e){this.sprite.x=e.x,this.sprite.y=e.y,this.sprite.alpha=1,this.launchLivingTimer(),this.sprite.revive()}},{key:"kill",value:function(){this.livingTimer.stop(!0),this.dyingTimer.stop(!0),this.sprite.kill()}}]),e}();t.a=a},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(397),a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(t){var i=t.game,a=t.onTogglePoster;r(this,e),this.game=i,this.onTogglePoster=a,this.group=this.game.add.group(),this.group.fixedToCamera=!0,this.score=new s.a({game:this.game,x:this.game.width/2,y:this.game.height-20,width:Math.min(this.game.width/2,250)}),this.group.add(this.score.group),this.textScore=this.game.add.text(this.game.width-20,20,"",{font:"25px Arial",fill:"#fff"}),this.textScore.anchor.set(1,0),this.textScore.setShadow(2,2,"rgba(0, 0, 0, .8)",0),this.group.add(this.textScore),this.buttonSound=this.game.add.button(10,10,"soundButtons",this.handleClickSound,this,1,1,1,1,this.group),this.buttonSound.input.priorityID=2,Phaser.Device.desktop||(this.buttonPoster=this.game.add.button(this.game.width-20,this.game.height-20,"helpPoster",this.handleTogglePoster,this,1,1,1,1,this.group),this.buttonPoster.anchor.set(1,1),this.buttonPoster.input.priorityID=2)}return a(e,[{key:"update",value:function(e){var t=e.score,i=e.protestersAlive,r=e.protestersTotal,s=e.meanMood;this.buttonSound.frame=this.game.sound.mute?1:0,this.score.update({score:t,protestersAlive:i,protestersTotal:r,mood:100*s})}},{key:"updateScore",value:function(e){this.textScore.setText(e)}},{key:"handleClickSound",value:function(){this.game.sound.mute=!this.game.sound.mute}},{key:"handleTogglePoster",value:function(){this.onTogglePoster()}},{key:"kill",value:function(){this.group.killAll()}}]),e}();t.a=n},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(t){var i=t.game,a=t.x,n=t.y,o=t.width;r(this,e),this.game=i,this.group=this.game.add.group(),this.group.x=a,this.group.y=n,this.width=o,this.scoreMeter=this.game.add.graphics(),this.group.add(this.scoreMeter),this.moodMeter=this.game.add.graphics(),this.group.add(this.moodMeter),this.aliveMeter=this.game.add.graphics(),this.group.add(this.aliveMeter),this.label=this.game.add.text(-this.width/2+20,-8,this.game.mz.i18n.getTranslation(s.L),{font:"12px Arial",fill:"#000",align:"right"}),this.group.add(this.label)}return a(e,[{key:"update",value:function(e){var t=e.score,i=e.mood,r=e.protestersAlive,s=e.protestersTotal;this.updateScoreMeter(t),this.updateAliveMeter(r,s),this.updateMoodMeter(i)}},{key:"updateScoreMeter",value:function(e){this.updateMeter({graphics:this.scoreMeter,value:e,width:this.width,height:16,x:-this.width/2,y:0,colorThreshold:30})}},{key:"updateAliveMeter",value:function(e,t){this.updateMeter({graphics:this.aliveMeter,value:100*e/t,width:this.width/2-1,height:6,x:-this.width/2,y:13,colorThreshold:50})}},{key:"updateMoodMeter",value:function(e){this.updateMeter({graphics:this.moodMeter,value:e,width:this.width/2-1,height:6,x:1,y:13,colorThreshold:50})}},{key:"updateMeter",value:function(e){var t=e.graphics,i=e.value,r=e.width,s=e.height,a=e.x,n=e.y,o=e.colorThreshold;t.clear();var h=Phaser.Color.RGBArrayToHex([this.game.math.clamp(1+(o-i)/(100-o),0,1),this.game.math.clamp(i/o,0,1),0]);t.lineStyle(s,16777215,.9),t.moveTo(a,n),t.lineTo(a+r,n),t.lineStyle(s,h,1),t.moveTo(a,n),t.lineTo(a+Math.round(r*i/100),n)}}]),e}();t.a=n},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),n=function(){function e(t){var i=t.game;r(this,e),this.game=i,this.sprite=this.game.add.sprite(0,0),this.overlay=this.game.add.graphics(0,0),this.overlay.beginFill(16777215,.7),this.overlay.drawRect(0,0,this.game.width,this.game.height),this.overlay.endFill(),this.title=this.game.add.text(this.game.width/2,2/3*this.game.height/2,this.game.mz.i18n.getTranslation(s.K)),this.title.anchor.set(.5),this.replayButton=this.game.add.sprite(this.game.width/2,this.game.height/2,"playButton"),this.replayButton.anchor.set(.5),this.sprite.addChild(this.overlay),this.sprite.addChild(this.title),this.sprite.addChild(this.replayButton),this.sprite.fixedToCamera=!0,this.kill()}return a(e,[{key:"kill",value:function(){this.sprite.kill()}},{key:"revive",value:function(){this.sprite.revive()}}]),e}();t.a=n},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(8),a=i(141),n=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),h=1500,l=3e3,u=function(){function e(t){var i=t.game,s=t.mode,a=t.score,n=t.stats;r(this,e),this.game=i,this.mode=s,this.stats=n;var o=this.game.height/6;this.sprite=this.game.add.sprite(0,0),this.sprite.fixedToCamera=!0,this.topStripe=this.game.add.graphics(0,0),this.topStripe.beginFill(0),this.topStripe.drawRect(0,-o,this.game.width,o),this.topStripe.endFill(),this.game.add.tween(this.topStripe).to({top:o},h).start().onComplete.addOnce(this.handleTweenComplete,this),this.bottomStripe=this.game.add.graphics(0,0),this.bottomStripe.beginFill(0),this.bottomStripe.drawRect(0,this.game.height,this.game.width,this.game.height+o),this.bottomStripe.endFill(),this.game.add.tween(this.bottomStripe).to({top:-o},h).start(),this.overlay=this.game.add.graphics(0,0),this.overlay.beginFill(0),this.overlay.drawRect(0,0,this.game.width,this.game.height),this.overlay.endFill(),this.overlay.alpha=0,this.game.add.tween(this.overlay).to({alpha:.5},l).start().onComplete.addOnce(this.showStats,this),this.replayButton=this.game.add.button(this.game.width-50,50,"repeatButton",this.handleClickPlay,this),this.replayButton.anchor.set(.5),this.replayButton.visible=!1,this.sprite.addChild(this.topStripe),this.sprite.addChild(this.bottomStripe),this.sprite.addChild(this.overlay),this.sprite.addChild(this.replayButton),this.sprite.addChild(a)}return o(e,[{key:"handleTweenComplete",value:function(){this.replayButton.visible=!0}},{key:"handleClickPlay",value:function(){this.game.state.start("StartMenu")}},{key:"showStats",value:function(){var e=this,t="";this.mode===s.j?t=s.t:this.mode===s.g?t=s.q:this.mode===s.i?t=s.s:this.mode===s.h&&(t=s.r);var i=this.game.width/15,r=this.game.add.text(i,40,this.game.mz.i18n.getTranslation(t),{font:"26px Arial",fill:this.mode===s.j?"#393":"#933",wordWrap:!0,wordWrapWidth:this.replayButton.left-2*i});this.sprite.addChild(r);var o=[[s.I,this.stats.revived],[s.E,this.stats.alive],[s.F,this.stats.arrested],[s.G,this.stats.left]];this.mode!==s.i&&o.unshift([s.H,String(a.a(this.stats.time))]);var h=r.bottom+r.top,l=0;o.forEach(function(t,r){var s=n(t,1),a=s[0],o=e.game.add.text(i,40*r+h,e.game.mz.i18n.getTranslation(a)+":",{font:"24px Arial",fill:"#fff"});o.width>l&&(l=o.width),e.sprite.addChild(o)}),l+=2*i,o.forEach(function(t,i){var r=n(t,2),s=(r[0],r[1]),a=e.game.add.text(l,40*i+h,String(s),{font:"24px Arial",fill:"#fff"});e.sprite.addChild(a)})}}]),e}();t.a=u},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(142),a=i(401),n=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),h=function(){function e(t){var i=t.game,s=t.gameObject,a=t.scale;r(this,e),Object.assign(this,{game:i,gameObject:s,scale:a,entities:[]})}return o(e,[{key:"update",value:function(){new a.a(this).update()}},{key:"addEntity",value:function(e){var t=e.sprite,i=e.object;this.entities.push({sprite:t,object:i,move:[],personalMatrix:this.compilePersonalMatrix(t)})}},{key:"moveEntity",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.callback,s=void 0===r?function(){}:r,a=i.phasing,n=void 0!==a&&a,o=i.follow,h=void 0!==o&&o,l=i.reset,u=void 0===l||l,c=this.entities.find(function(t){return t.object===e});if(!c&&t)throw new Error("object not registered ("+e+")");c&&(u&&(c.move=[]),t&&c.move.push({target:t,callback:s,follow:h,phasing:n}))}},{key:"moveToFactory",value:function(){var e=this;return function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.moveEntity(this,t,i)}}},{key:"compilePersonalMatrix",value:function(e){for(var t=new s.a(this),i=t.rCoordsToMCoords(e.body.center),r=n(i,2),a=r[0],o=r[1],h=t.rCoordsToMCoords(e.body),l=n(h,2),u=l[0],c=l[1],p=t.rCoordsToMCoords({x:e.body.x+e.body.width,y:e.body.y+e.body.height}),d=n(p,2),m=d[0],f=d[1],g=e.body,y=(g.height,g.width,g.x,g.y,g.center,[]),v=u;v<=m;v++)for(var b=c;b<=f;b++)y.push([v-a,b-o]);return y}},{key:"invokeRawMoving",value:function(e,t){e.setVelocity(t)}}]),e}();t.a=h},function(e,t,i){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!t)return null;var i=p(t,2),r=i[0];return e[i[1]][r]}function n(e,t,i){if(t){var r=p(t,2),s=r[0];e[r[1]][s]=i}}function o(e,t){for(var i=[],r=0;r<t;r++){i[r]=[];for(var s=0;s<e;s++)i[r][s]=!1}return i}function h(e,t){var i=p(e,2),r=i[0],s=i[1],a=p(t,2),n=a[0],o=a[1];return r===n&&s===o}var l=i(402),u=i.n(l),c=i(142),p=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),m=function(){function e(t){s(this,e),this.collider=t,this.converter=new c.a(t),this.matrix=this._buildMatrix()}return d(e,[{key:"update",value:function(){var e=this,t=this.collider,i=this.converter;t.entities.forEach(function(r){var s=r.move,n=r.sprite,o=r.object,l=r.personalMatrix;if(0===s.length)return void(n.mz&&n.mz.stop());var c=s[0],p=c.target,d=c.phasing,m=c.follow,f=c.callback,g=i.rCoordsToMCoords(n.body.center),y=i.rCoordsToMCoords(p);if(d){n.phasing=!0;var v=[g,y],b=!h(g,y)}else var w=new u.a.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}),v=e._findPath({finder:w,from:g,to:y,personalMatrix:l}),b=v[2]||!1===a(e.matrix,v[1]);if(b){var k=i.mCoordsToRCoords(v[1]);t.invokeRawMoving(o,k)}else{if(m)return void n.body.stop();f&&f(),n.phasing=!1,s.shift()}})}},{key:"_findPath",value:function(e){var t=e.finder,i=e.from,s=e.to,a=e.personalMatrix,o=this._cloneMatrix();this._applyPersonalMatrix(!1,{personalMatrix:a,target:i,matrix:o}),n(o,s,!1);var h=new u.a.Grid(o);return t.findPath.apply(t,r(i).concat(r(s),[h]))}},{key:"_buildMatrix",value:function(){var e=this.converter,t=e.maxX,i=e.maxY,r=o(t+1,i+1),s=!0,a=!1,n=void 0;try{for(var h,l=this.collider.entities[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var u=h.value,c=u.sprite,p=u.personalMatrix;if(c.alive&&(!c.mz||null!==c.mz.mode)){var d=this.converter.rCoordsToMCoords(c.body.center);this._applyPersonalMatrix(!0,{personalMatrix:p,target:d,matrix:r})}}}catch(e){a=!0,n=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw n}}return r}},{key:"_applyPersonalMatrix",value:function(e,t){var i=t.personalMatrix,r=t.target,s=t.matrix,a=this.converter,o=a.maxX,h=a.maxY,l=p(r,2),u=l[0],c=l[1];i.forEach(function(t){var i=p(t,2),r=i[0],a=i[1];n(s,[Math.max(Math.min(u+r,o),0),Math.max(Math.min(c+a,h),0)],e)})}},{key:"_cloneMatrix",value:function(){return this.matrix.map(function(e){return e.map(function(e){return e})})}}]),e}();t.a=m},function(e,t,i){e.exports=i(403)},function(e,t,i){e.exports={Heap:i(63),Node:i(90),Grid:i(406),Util:i(42),DiagonalMovement:i(14),Heuristic:i(51),AStarFinder:i(91),BestFirstFinder:i(407),BreadthFirstFinder:i(408),DijkstraFinder:i(409),BiAStarFinder:i(92),BiBestFirstFinder:i(410),BiBreadthFirstFinder:i(411),BiDijkstraFinder:i(412),IDAStarFinder:i(413),JumpPointFinder:i(414)}},function(e,t,i){(function(e){(function(){var t,i,r,s,a,n,o,h,l,u,c,p,d,m,f;r=Math.floor,u=Math.min,i=function(e,t){return e<t?-1:e>t?1:0},l=function(e,t,s,a,n){var o;if(null==s&&(s=0),null==n&&(n=i),s<0)throw new Error("lo must be non-negative");for(null==a&&(a=e.length);s<a;)o=r((s+a)/2),n(t,e[o])<0?a=o:s=o+1;return[].splice.apply(e,[s,s-s].concat(t)),t},n=function(e,t,r){return null==r&&(r=i),e.push(t),m(e,0,e.length-1,r)},a=function(e,t){var r,s;return null==t&&(t=i),r=e.pop(),e.length?(s=e[0],e[0]=r,f(e,0,t)):s=r,s},h=function(e,t,r){var s;return null==r&&(r=i),s=e[0],e[0]=t,f(e,0,r),s},o=function(e,t,r){var s;return null==r&&(r=i),e.length&&r(e[0],t)<0&&(s=[e[0],t],t=s[0],e[0]=s[1],f(e,0,r)),t},s=function(e,t){var s,a,n,o,h,l;for(null==t&&(t=i),o=function(){l=[];for(var t=0,i=r(e.length/2);0<=i?t<i:t>i;0<=i?t++:t--)l.push(t);return l}.apply(this).reverse(),h=[],a=0,n=o.length;a<n;a++)s=o[a],h.push(f(e,s,t));return h},d=function(e,t,r){var s;if(null==r&&(r=i),-1!==(s=e.indexOf(t)))return m(e,0,s,r),f(e,s,r)},c=function(e,t,r){var a,n,h,l,u;if(null==r&&(r=i),n=e.slice(0,t),!n.length)return n;for(s(n,r),u=e.slice(t),h=0,l=u.length;h<l;h++)a=u[h],o(n,a,r);return n.sort(r).reverse()},p=function(e,t,r){var n,o,h,c,p,d,m,f,g;if(null==r&&(r=i),10*t<=e.length){if(h=e.slice(0,t).sort(r),!h.length)return h;for(o=h[h.length-1],m=e.slice(t),c=0,d=m.length;c<d;c++)n=m[c],r(n,o)<0&&(l(h,n,0,null,r),h.pop(),o=h[h.length-1]);return h}for(s(e,r),g=[],p=0,f=u(t,e.length);0<=f?p<f:p>f;0<=f?++p:--p)g.push(a(e,r));return g},m=function(e,t,r,s){var a,n,o;for(null==s&&(s=i),a=e[r];r>t&&(o=r-1>>1,n=e[o],s(a,n)<0);)e[r]=n,r=o;return e[r]=a},f=function(e,t,r){var s,a,n,o,h;for(null==r&&(r=i),a=e.length,h=t,n=e[t],s=2*t+1;s<a;)o=s+1,o<a&&!(r(e[s],e[o])<0)&&(s=o),e[t]=e[s],t=s,s=2*t+1;return e[t]=n,m(e,h,t,r)},t=function(){function e(e){this.cmp=null!=e?e:i,this.nodes=[]}return e.push=n,e.pop=a,e.replace=h,e.pushpop=o,e.heapify=s,e.updateItem=d,e.nlargest=c,e.nsmallest=p,e.prototype.push=function(e){return n(this.nodes,e,this.cmp)},e.prototype.pop=function(){return a(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return h(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return o(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return s(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return d(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),(void 0!==e&&null!==e?e.exports:void 0)?e.exports=t:window.Heap=t}).call(this)}).call(t,i(405)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){function r(e,t,i){var r;"object"!=typeof e?r=e:(t=e.length,r=e[0].length,i=e),this.width=r,this.height=t,this.nodes=this._buildNodes(r,t,i)}var s=i(90),a=i(14);r.prototype._buildNodes=function(e,t,i){var r,a,n=new Array(t);for(r=0;r<t;++r)for(n[r]=new Array(e),a=0;a<e;++a)n[r][a]=new s(a,r);if(void 0===i)return n;if(i.length!==t||i[0].length!==e)throw new Error("Matrix size does not fit");for(r=0;r<t;++r)for(a=0;a<e;++a)i[r][a]&&(n[r][a].walkable=!1);return n},r.prototype.getNodeAt=function(e,t){return this.nodes[t][e]},r.prototype.isWalkableAt=function(e,t){return this.isInside(e,t)&&this.nodes[t][e].walkable},r.prototype.isInside=function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height},r.prototype.setWalkableAt=function(e,t,i){this.nodes[t][e].walkable=i},r.prototype.getNeighbors=function(e,t){var i=e.x,r=e.y,s=[],n=!1,o=!1,h=!1,l=!1,u=!1,c=!1,p=!1,d=!1,m=this.nodes;if(this.isWalkableAt(i,r-1)&&(s.push(m[r-1][i]),n=!0),this.isWalkableAt(i+1,r)&&(s.push(m[r][i+1]),h=!0),this.isWalkableAt(i,r+1)&&(s.push(m[r+1][i]),u=!0),this.isWalkableAt(i-1,r)&&(s.push(m[r][i-1]),p=!0),t===a.Never)return s;if(t===a.OnlyWhenNoObstacles)o=p&&n,l=n&&h,c=h&&u,d=u&&p;else if(t===a.IfAtMostOneObstacle)o=p||n,l=n||h,c=h||u,d=u||p;else{if(t!==a.Always)throw new Error("Incorrect value of diagonalMovement");o=!0,l=!0,c=!0,d=!0}return o&&this.isWalkableAt(i-1,r-1)&&s.push(m[r-1][i-1]),l&&this.isWalkableAt(i+1,r-1)&&s.push(m[r-1][i+1]),c&&this.isWalkableAt(i+1,r+1)&&s.push(m[r+1][i+1]),d&&this.isWalkableAt(i-1,r+1)&&s.push(m[r+1][i-1]),s},r.prototype.clone=function(){var e,t,i=this.width,a=this.height,n=this.nodes,o=new r(i,a),h=new Array(a);for(e=0;e<a;++e)for(h[e]=new Array(i),t=0;t<i;++t)h[e][t]=new s(t,e,n[e][t].walkable);return o.nodes=h,o},e.exports=r},function(e,t,i){function r(e){s.call(this,e);var t=this.heuristic;this.heuristic=function(e,i){return 1e6*t(e,i)}}var s=i(91);r.prototype=new s,r.prototype.constructor=r,e.exports=r},function(e,t,i){function r(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never)}var s=i(42),a=i(14);r.prototype.findPath=function(e,t,i,r,a){var n,o,h,l,u,c=[],p=this.diagonalMovement,d=a.getNodeAt(e,t),m=a.getNodeAt(i,r);for(c.push(d),d.opened=!0;c.length;){if(h=c.shift(),h.closed=!0,h===m)return s.backtrace(m);for(n=a.getNeighbors(h,p),l=0,u=n.length;l<u;++l)o=n[l],o.closed||o.opened||(c.push(o),o.opened=!0,o.parent=h)}return[]},e.exports=r},function(e,t,i){function r(e){s.call(this,e),this.heuristic=function(e,t){return 0}}var s=i(91);r.prototype=new s,r.prototype.constructor=r,e.exports=r},function(e,t,i){function r(e){s.call(this,e);var t=this.heuristic;this.heuristic=function(e,i){return 1e6*t(e,i)}}var s=i(92);r.prototype=new s,r.prototype.constructor=r,e.exports=r},function(e,t,i){function r(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never)}var s=i(42),a=i(14);r.prototype.findPath=function(e,t,i,r,a){var n,o,h,l,u,c=a.getNodeAt(e,t),p=a.getNodeAt(i,r),d=[],m=[],f=this.diagonalMovement;for(d.push(c),c.opened=!0,c.by=0,m.push(p),p.opened=!0,p.by=1;d.length&&m.length;){for(h=d.shift(),h.closed=!0,n=a.getNeighbors(h,f),l=0,u=n.length;l<u;++l)if(o=n[l],!o.closed)if(o.opened){if(1===o.by)return s.biBacktrace(h,o)}else d.push(o),o.parent=h,o.opened=!0,o.by=0;for(h=m.shift(),h.closed=!0,n=a.getNeighbors(h,f),l=0,u=n.length;l<u;++l)if(o=n[l],!o.closed)if(o.opened){if(0===o.by)return s.biBacktrace(o,h)}else m.push(o),o.parent=h,o.opened=!0,o.by=1}return[]},e.exports=r},function(e,t,i){function r(e){s.call(this,e),this.heuristic=function(e,t){return 0}}var s=i(92);r.prototype=new s,r.prototype.constructor=r,e.exports=r},function(e,t,i){function r(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||s.manhattan,this.weight=e.weight||1,this.trackRecursion=e.trackRecursion||!1,this.timeLimit=e.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=n.OnlyWhenNoObstacles:this.diagonalMovement=n.IfAtMostOneObstacle:this.diagonalMovement=n.Never),this.diagonalMovement===n.Never?this.heuristic=e.heuristic||s.manhattan:this.heuristic=e.heuristic||s.octile}var s=(i(42),i(51)),a=i(90),n=i(14);r.prototype.findPath=function(e,t,i,r,s){var n,o,h,l=0,u=(new Date).getTime(),c=function(e,t){return this.heuristic(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}.bind(this),p=function(e,t){return e.x===t.x||e.y===t.y?1:Math.SQRT2},d=function(e,t,i,r,n){if(l++,this.timeLimit>0&&(new Date).getTime()-u>1e3*this.timeLimit)return 1/0;var o=t+c(e,f)*this.weight;if(o>i)return o;if(e==f)return r[n]=[e.x,e.y],e;var h,m,g,y,v=s.getNeighbors(e,this.diagonalMovement);for(g=0,h=1/0;y=v[g];++g){if(this.trackRecursion&&(y.retainCount=y.retainCount+1||1,!0!==y.tested&&(y.tested=!0)),(m=d(y,t+p(e,y),i,r,n+1))instanceof a)return r[n]=[e.x,e.y],m;this.trackRecursion&&0==--y.retainCount&&(y.tested=!1),m<h&&(h=m)}return h}.bind(this),m=s.getNodeAt(e,t),f=s.getNodeAt(i,r),g=c(m,f);for(n=0;!0;++n){if(o=[],(h=d(m,0,g,o,0))===1/0)return[];if(h instanceof a)return o;g=h}return[]},e.exports=r},function(e,t,i){function r(e){return e=e||{},e.diagonalMovement===s.Never?new a(e):e.diagonalMovement===s.Always?new n(e):e.diagonalMovement===s.OnlyWhenNoObstacles?new o(e):new h(e)}var s=i(14),a=i(415),n=i(416),o=i(417),h=i(418);e.exports=r},function(e,t,i){function r(e){s.call(this,e)}var s=i(64),a=i(14);r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(e,t,i,r){var s=this.grid,a=e-i,n=t-r;if(!s.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(s.getNodeAt(e,t).tested=!0),s.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==a){if(s.isWalkableAt(e,t-1)&&!s.isWalkableAt(e-a,t-1)||s.isWalkableAt(e,t+1)&&!s.isWalkableAt(e-a,t+1))return[e,t]}else{if(0===n)throw new Error("Only horizontal and vertical movements are allowed");if(s.isWalkableAt(e-1,t)&&!s.isWalkableAt(e-1,t-n)||s.isWalkableAt(e+1,t)&&!s.isWalkableAt(e+1,t-n))return[e,t];if(this._jump(e+1,t,e,t)||this._jump(e-1,t,e,t))return[e,t]}return this._jump(e+a,t+n,e,t)},r.prototype._findNeighbors=function(e){var t,i,r,s,n,o,h,l,u=e.parent,c=e.x,p=e.y,d=this.grid,m=[];if(u)t=u.x,i=u.y,r=(c-t)/Math.max(Math.abs(c-t),1),s=(p-i)/Math.max(Math.abs(p-i),1),0!==r?(d.isWalkableAt(c,p-1)&&m.push([c,p-1]),d.isWalkableAt(c,p+1)&&m.push([c,p+1]),d.isWalkableAt(c+r,p)&&m.push([c+r,p])):0!==s&&(d.isWalkableAt(c-1,p)&&m.push([c-1,p]),d.isWalkableAt(c+1,p)&&m.push([c+1,p]),d.isWalkableAt(c,p+s)&&m.push([c,p+s]));else for(n=d.getNeighbors(e,a.Never),h=0,l=n.length;h<l;++h)o=n[h],m.push([o.x,o.y]);return m},e.exports=r},function(e,t,i){function r(e){s.call(this,e)}var s=i(64),a=i(14);r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(e,t,i,r){var s=this.grid,a=e-i,n=t-r;if(!s.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(s.getNodeAt(e,t).tested=!0),s.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==a&&0!==n){if(s.isWalkableAt(e-a,t+n)&&!s.isWalkableAt(e-a,t)||s.isWalkableAt(e+a,t-n)&&!s.isWalkableAt(e,t-n))return[e,t];if(this._jump(e+a,t,e,t)||this._jump(e,t+n,e,t))return[e,t]}else if(0!==a){if(s.isWalkableAt(e+a,t+1)&&!s.isWalkableAt(e,t+1)||s.isWalkableAt(e+a,t-1)&&!s.isWalkableAt(e,t-1))return[e,t]}else if(s.isWalkableAt(e+1,t+n)&&!s.isWalkableAt(e+1,t)||s.isWalkableAt(e-1,t+n)&&!s.isWalkableAt(e-1,t))return[e,t];return this._jump(e+a,t+n,e,t)},r.prototype._findNeighbors=function(e){var t,i,r,s,n,o,h,l,u=e.parent,c=e.x,p=e.y,d=this.grid,m=[];if(u)t=u.x,i=u.y,r=(c-t)/Math.max(Math.abs(c-t),1),s=(p-i)/Math.max(Math.abs(p-i),1),0!==r&&0!==s?(d.isWalkableAt(c,p+s)&&m.push([c,p+s]),d.isWalkableAt(c+r,p)&&m.push([c+r,p]),d.isWalkableAt(c+r,p+s)&&m.push([c+r,p+s]),d.isWalkableAt(c-r,p)||m.push([c-r,p+s]),d.isWalkableAt(c,p-s)||m.push([c+r,p-s])):0===r?(d.isWalkableAt(c,p+s)&&m.push([c,p+s]),d.isWalkableAt(c+1,p)||m.push([c+1,p+s]),d.isWalkableAt(c-1,p)||m.push([c-1,p+s])):(d.isWalkableAt(c+r,p)&&m.push([c+r,p]),d.isWalkableAt(c,p+1)||m.push([c+r,p+1]),d.isWalkableAt(c,p-1)||m.push([c+r,p-1]));else for(n=d.getNeighbors(e,a.Always),h=0,l=n.length;h<l;++h)o=n[h],m.push([o.x,o.y]);return m},e.exports=r},function(e,t,i){function r(e){s.call(this,e)}var s=i(64),a=i(14);r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(e,t,i,r){var s=this.grid,a=e-i,n=t-r;if(!s.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(s.getNodeAt(e,t).tested=!0),s.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==a&&0!==n){if(this._jump(e+a,t,e,t)||this._jump(e,t+n,e,t))return[e,t]}else if(0!==a){if(s.isWalkableAt(e,t-1)&&!s.isWalkableAt(e-a,t-1)||s.isWalkableAt(e,t+1)&&!s.isWalkableAt(e-a,t+1))return[e,t]}else if(0!==n&&(s.isWalkableAt(e-1,t)&&!s.isWalkableAt(e-1,t-n)||s.isWalkableAt(e+1,t)&&!s.isWalkableAt(e+1,t-n)))return[e,t];return s.isWalkableAt(e+a,t)&&s.isWalkableAt(e,t+n)?this._jump(e+a,t+n,e,t):null},r.prototype._findNeighbors=function(e){var t,i,r,s,n,o,h,l,u=e.parent,c=e.x,p=e.y,d=this.grid,m=[];if(u)if(t=u.x,i=u.y,r=(c-t)/Math.max(Math.abs(c-t),1),s=(p-i)/Math.max(Math.abs(p-i),1),0!==r&&0!==s)d.isWalkableAt(c,p+s)&&m.push([c,p+s]),d.isWalkableAt(c+r,p)&&m.push([c+r,p]),d.isWalkableAt(c,p+s)&&d.isWalkableAt(c+r,p)&&m.push([c+r,p+s]);else{var f;if(0!==r){f=d.isWalkableAt(c+r,p);var g=d.isWalkableAt(c,p+1),y=d.isWalkableAt(c,p-1);f&&(m.push([c+r,p]),g&&m.push([c+r,p+1]),y&&m.push([c+r,p-1])),g&&m.push([c,p+1]),y&&m.push([c,p-1])}else if(0!==s){f=d.isWalkableAt(c,p+s);var v=d.isWalkableAt(c+1,p),b=d.isWalkableAt(c-1,p);f&&(m.push([c,p+s]),v&&m.push([c+1,p+s]),b&&m.push([c-1,p+s])),v&&m.push([c+1,p]),b&&m.push([c-1,p])}}else for(n=d.getNeighbors(e,a.OnlyWhenNoObstacles),h=0,l=n.length;h<l;++h)o=n[h],m.push([o.x,o.y]);return m},e.exports=r},function(e,t,i){function r(e){s.call(this,e)}var s=i(64),a=i(14);r.prototype=new s,r.prototype.constructor=r,r.prototype._jump=function(e,t,i,r){var s=this.grid,a=e-i,n=t-r;if(!s.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(s.getNodeAt(e,t).tested=!0),s.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==a&&0!==n){if(s.isWalkableAt(e-a,t+n)&&!s.isWalkableAt(e-a,t)||s.isWalkableAt(e+a,t-n)&&!s.isWalkableAt(e,t-n))return[e,t];if(this._jump(e+a,t,e,t)||this._jump(e,t+n,e,t))return[e,t]}else if(0!==a){if(s.isWalkableAt(e+a,t+1)&&!s.isWalkableAt(e,t+1)||s.isWalkableAt(e+a,t-1)&&!s.isWalkableAt(e,t-1))return[e,t]}else if(s.isWalkableAt(e+1,t+n)&&!s.isWalkableAt(e+1,t)||s.isWalkableAt(e-1,t+n)&&!s.isWalkableAt(e-1,t))return[e,t];return s.isWalkableAt(e+a,t)||s.isWalkableAt(e,t+n)?this._jump(e+a,t+n,e,t):null},r.prototype._findNeighbors=function(e){var t,i,r,s,n,o,h,l,u=e.parent,c=e.x,p=e.y,d=this.grid,m=[];if(u)t=u.x,i=u.y,r=(c-t)/Math.max(Math.abs(c-t),1),s=(p-i)/Math.max(Math.abs(p-i),1),0!==r&&0!==s?(d.isWalkableAt(c,p+s)&&m.push([c,p+s]),d.isWalkableAt(c+r,p)&&m.push([c+r,p]),(d.isWalkableAt(c,p+s)||d.isWalkableAt(c+r,p))&&m.push([c+r,p+s]),!d.isWalkableAt(c-r,p)&&d.isWalkableAt(c,p+s)&&m.push([c-r,p+s]),!d.isWalkableAt(c,p-s)&&d.isWalkableAt(c+r,p)&&m.push([c+r,p-s])):0===r?d.isWalkableAt(c,p+s)&&(m.push([c,p+s]),d.isWalkableAt(c+1,p)||m.push([c+1,p+s]),d.isWalkableAt(c-1,p)||m.push([c-1,p+s])):d.isWalkableAt(c+r,p)&&(m.push([c+r,p]),d.isWalkableAt(c,p+1)||m.push([c+r,p+1]),d.isWalkableAt(c,p-1)||m.push([c+r,p-1]));else for(n=d.getNeighbors(e,a.IfAtMostOneObstacle),h=0,l=n.length;h<l;++h)o=n[h],m.push([o.x,o.y]);return m},e.exports=r},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a=function(){function e(t,i){r(this,e),this.scale=t.scale,this.camera=t,this.game=i,this.bounds=Phaser.Rectangle.clone(this.game.camera.bounds)}return s(e,[{key:"zoomTo",value:function(e,t){var i=this.bounds;this.scale=e;var r=this.game.camera.bounds;return game.add.tween(r).to({x:i.width*(1-e)/2,y:i.height*(1-e)/2,width:i.width*e,height:i.height*e},t).start(),game.add.tween(this.game.camera.scale).to({x:e,y:e},t).start()}}]),e}();t.a=a},function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a={0:{id:0,name:"Денис Стяжкин",text:"#Москва на Белорусской задержали уже 10 человек",nickname:"styazshkin",type:"arrest"},1:{id:1,name:"Грани.ру",text:"У Пушкина начали задерживать праздношатающихся",nickname:"granitweet",type:"arrest"},2:{id:2,name:"Vyacheslav Gimadi",text:"Меня задержали. Шёл по Тверской в кроссовках. #ДимонОтветит и мы победим!",nickname:"vigimadi",type:"arrest"},3:{id:3,name:"ОВД-Инфо",text:"В Москве на акциях против коррупции задержано более 130 человек. Задержания в настоящий момент продолжаются на Тверской.",nickname:"ovdinfo",type:"arrest"},4:{id:4,name:"мутабор",text:"даже не дошла до митинга и уже в автозаке",nickname:"koshelyaeva",type:"arrest"},5:{id:5,name:"Andrey Pivovarov",text:"Задержали депутата Максима Резника",nickname:"brewerov",type:"arrest"},6:{id:6,name:"швец д",text:"круто (увезли)",nickname:"asilikedem",type:"arrest"},7:{id:7,name:"Александр Паль",text:"В автозаке тепло.",nickname:"tw_fb_pal",type:"arrest"},8:{id:8,name:"Ян Кателевский",text:"Жёстко повязали, сорвали пресс карта избили ногами и лубинками, повредили трахею когда душили, били головой об автозак",nickname:"ya_yanson",type:"omon"},9:{id:9,name:"Юлия Галямина",text:"Омоновец дал мне кулаком в лицо. Мужа сильно избили, сломали очки",nickname:"galiamina",type:"omon"},10:{id:10,name:"ОГОН",text:"Задержанных около Тверского бульвара бьют головой об автозак, и дубинкой по ногам. Автозак номер о0577 до этого был у Известий #12июня",nickname:"ogonwatch",type:"omon"},11:{id:11,name:"The Insider",text:"Полиция уже избивает дубинками людей. Всех, без разбору.",nickname:"the_ins_ru",type:"omon"},12:{id:12,name:"Алексей Кириленко",text:"Омон надел противогаз #ДеньРоссии",nickname:"kirilenko_a",type:"omon"},13:{id:13,name:"Телеканал Дождь",text:"На вид мальчику не больше 12-13 лет.",nickname:"tvrain",type:"omon"},14:{id:14,name:"Пётр Верзилов",text:"На  Пушкинский ОМОН двигается боевыми квадратами, валит людей на землю и задерживает.",nickname:"gruppa_voina",type:"omon"},15:{id:15,name:"Пётр Верзилов",text:"Парня повалили на землю возле памятника Пушкину и бьют, заломив руки за спину",nickname:"gruppa_voina",type:"omon"},16:{id:16,name:"ТоталитаризмЖараИюль",text:"ОМОН разбивает толпу",nickname:"kszhivago",type:"omon"},17:{id:17,name:"Plushev",text:"Толпа не отдаёт задержанных",nickname:"plushev",type:"defended"},18:{id:18,name:"Алексей Абанин",text:"Большая куча вместе с @navalny идёт в сторону пушкинской от маяковской",nickname:"aban_in",type:"star"},19:{id:19,name:"Рубанов Роман",text:"Навального задержали",nickname:"rrubanov",type:"star"},20:{id:20,name:"Навальный",text:"Ребята, со мной все хорошо. Не надо меня отбивать. Идите по Тверской. Наша сегодняшняя тема - борьба с коррупцией",nickname:"navalny",type:"star"},21:{id:21,name:"Пётр Верзилов",text:"Народ все прибывает на Пушкинскую, идут задержания",nickname:"gruppa_voina",type:"star"},22:{id:22,name:"Пётр Верзилов",text:"Медиамагнат Пётр Верзилов был задержан на Пушкинской площади в Москве.",nickname:"gruppa_voina",type:"star"},23:{id:23,name:"Пётр Верзилов",text:'Уау, в нашем автозаке актёр Александр Паль, лауреат премии "Кинотавра" за лучшую мужскую роль в фильме "Тряпичный союз". Очень крутой фильм!',nickname:"gruppa_voina",type:"star"},24:{id:24,name:"Илья Варламов",text:"Лимонова задержали",nickname:"varlamov",type:"star"},25:{id:25,name:"Медиазона",text:"По предварительным данным, Лимонова повезут в ОВД по Тверскому району, остальных задержанных — в ОВД Красносельский",nickname:"mediazzzona",type:"star"},26:{id:26,name:"Телеканал Дождь",text:"Илья Яшин оказался в автозаке, хотя даже не успел совершить ничего провокационного и незаконного. Яшин рассказал, как его задержали, и кто оказался с ним в автозаке",nickname:"tvrain",type:"star"},27:{id:27,name:"Журавлева",text:"на тверской заставе омон, космонавты в черном, спецтехника и ШТАБ",nickname:"zhuravleva",type:"description"},28:{id:28,name:"Plushev",text:"Над Тверской вертолёт",nickname:"plushev",type:"description"},29:{id:29,name:"ОГОН",text:"На Охотном ряду выстаиваются сотрудники и устанавливают ограждения.",nickname:"ogonwatch",type:"description"},30:{id:30,name:"Alec Luhn",text:"I took a photo of police detaining a guy at @navalny protest so they detained me as well even though I repeatedly said I was a journalist",nickname:"asluhn",type:"journalist_arrest"},31:{id:31,name:"Feldman",text:"меня задержали на Пушкинской площади",nickname:"evgenyfeldman",type:"journalist_arrest"}},n=function(e){return{font:"16px Arial",fill:"white",wordWrap:!0,wordWrapWidth:e-93}},o=function(){function e(t){r(this,e),this.game=t,this.queue=[],this.executing=!1}return s(e,[{key:"find",value:function(e){var t=Object.values(a);return 1===Object.keys(e).length&&void 0!==e.id?[a[e.id]]:t.filter(function(t){var i=!1;return Object.keys(e).forEach(function(r){i=t[r]==e[r]}),i})}},{key:"rTweet",value:function(e,t){var i=this.find(e),r=i[~~Math.random()*i.length];this.showTweet(r.text,"tw_"+r.nickname,option)}},{key:"calcGroupPosition",value:function(e){return e._height<73?-73:-(e._height+25)}},{key:"pushToQueue",value:function(e,t){this.queue.push({tweetData:{text:e.text,image:e.image},anim:{visible:t.visible||1e3,fadeOut:t.fadeOut||1e3,fadeIn:t.fadeIn||1e3}})}},{key:"startQueue",value:function(){if(!this.executing){this.executing=!0;var e=this.queue.shift();console.log("n.kozh start tweet",e),window._h=e,e&&this.processTask(e.tweetData,e.anim)}}},{key:"processTask",value:function(e,t){var i=this,r=e.text,s=e.image,a=this.createHiddenTweet(r,s,t),n=a.tween,o=a.group;window._tween=n,n.onComplete.add(function(){console.log("n.kozh tween complete");var e=i.game.time.create(!0);window._timer=e,e.loop(5e3,function(){console.log("n.kozh visible timer end"),o.killAll(),o.destroy(),i.executing=!1,i.startQueue(),e.destroy()},i.game),e.start()}),n.start()}},{key:"createHiddenTweet",value:function(e,t,i){var r=this.game,s=r.width,a=r.height,o=this.game.add.group();window._tweetObj=o,window._text=e,window._image=t;var h=this.game.add.text(93,a,e,n(s)),l=this.game.add.sprite(0,0,t);l.alignTo(h,Phaser.LEFT_TOP,20);var u=game.add.graphics(49,a+24);u.beginFill(16777215),u.drawCircle(0,0,48),l.mask=u,o.add(u),o.add(l),o.add(h);var c=this.calcGroupPosition(h,o);o.alpha=0;var p=this.game.add.tween(o);return p.to({y:c,alpha:1},1e3,Phaser.Easing.Default,!0),window._ftween=p,{tween:p,group:o}}},{key:"_tweet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pushToQueue({text:e.text,image:e.image},t),this.startQueue()}},{key:"tweet",value:function(e,t,i){window._Tweets=this,console.log("n.kozh",e,t),this._tweet({text:e,image:t},i)}},{key:"showTweet",value:function(e,t,i){var r=this.game.add.group(),s=game.game,a=s.width,n=s.height,o=this.game.add.sprite(0,0,t),h=game.add.graphics(49,n+24);h.beginFill(16777215),h.drawCircle(0,0,48),o.mask=h,window._mask=h,window._avatar=o;var l=this.game.add.text(93,n,e,{font:"16px Arial",fill:"white",wordWrap:!0,wordWrapWidth:a-93});window._textGameObject=l,o.alignTo(l,Phaser.LEFT_TOP,20),window._tweetGroup=r;var u=this.calcGroupPosition(l,r);r.add(h),r.add(o),r.add(l),r.alpha=0;var c=this.game.add.tween(r);c.to({y:u,alpha:1},1e3,Phaser.Easing.Default,!0),this.animate=!0,c.start()}}]),e}();t.a=o},function(e,t,i){"use strict";var r=(i(62),{sprite:"paddy_wagon",speed:{value:100},group:"cars",immovable:!0,positions:[{x:0,y:0,angle:90}]});t.a={paddyWagon:r}},function(e,t,i){e.exports=i.p+"assets/5fbd3862ae5c5b4eff40d8a642ae2779.png"}]);